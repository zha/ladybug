<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ladybug.epw &#8212; ladybug  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          ladybug</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datatype.html">ladybug.datatype package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ladybug.datatype.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.angle.html">ladybug.datatype.angle module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.area.html">ladybug.datatype.area module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.base.html">ladybug.datatype.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.distance.html">ladybug.datatype.distance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energy.html">ladybug.datatype.energy module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energyflux.html">ladybug.datatype.energyflux module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energyintensity.html">ladybug.datatype.energyintensity module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.fraction.html">ladybug.datatype.fraction module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.generic.html">ladybug.datatype.generic module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.illuminance.html">ladybug.datatype.illuminance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.luminance.html">ladybug.datatype.luminance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.mass.html">ladybug.datatype.mass module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.massflowrate.html">ladybug.datatype.massflowrate module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.power.html">ladybug.datatype.power module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.pressure.html">ladybug.datatype.pressure module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.rvalue.html">ladybug.datatype.rvalue module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.specificenergy.html">ladybug.datatype.specificenergy module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.speed.html">ladybug.datatype.speed module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperature.html">ladybug.datatype.temperature module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperaturedelta.html">ladybug.datatype.temperaturedelta module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperaturetime.html">ladybug.datatype.temperaturetime module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.thermalcondition.html">ladybug.datatype.thermalcondition module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.uvalue.html">ladybug.datatype.uvalue module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.volume.html">ladybug.datatype.volume module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.volumeflowrate.html">ladybug.datatype.volumeflowrate module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ladybug.datatype.html#module-ladybug.datatype">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.analysisperiod.html">ladybug.analysisperiod module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.color.html">ladybug.color module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datacollection.html">ladybug.datacollection module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datacollectionimmutable.html">ladybug.datacollectionimmutable module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.designday.html">ladybug.designday module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.dt.html">ladybug.dt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.epw.html">ladybug.epw module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.futil.html">ladybug.futil module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.graphic.html">ladybug.graphic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.header.html">ladybug.header module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.legend.html">ladybug.legend module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.location.html">ladybug.location module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.psychrometrics.html">ladybug.psychrometrics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.rootfind.html">ladybug.rootfind module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.skymodel.html">ladybug.skymodel module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.stat.html">ladybug.stat module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.sunpath.html">ladybug.sunpath module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.wea.html">ladybug.wea module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#module-ladybug">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-4">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-8 content" role="main">
      
  <h1>Source code for ladybug.epw</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding=utf-8</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">.location</span> <span class="k">import</span> <span class="n">Location</span>
<span class="kn">from</span> <span class="nn">.designday</span> <span class="k">import</span> <span class="n">DesignDay</span>
<span class="kn">from</span> <span class="nn">.datacollection</span> <span class="k">import</span> <span class="n">HourlyContinuousCollection</span>
<span class="kn">from</span> <span class="nn">.datacollection</span> <span class="k">import</span> <span class="n">MonthlyCollection</span>
<span class="kn">from</span> <span class="nn">.header</span> <span class="k">import</span> <span class="n">Header</span>
<span class="kn">from</span> <span class="nn">.analysisperiod</span> <span class="k">import</span> <span class="n">AnalysisPeriod</span>
<span class="kn">from</span> <span class="nn">.datatype</span> <span class="k">import</span> <span class="n">angle</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">energyflux</span><span class="p">,</span> <span class="n">energyintensity</span><span class="p">,</span> <span class="n">generic</span><span class="p">,</span> \
    <span class="n">illuminance</span><span class="p">,</span> <span class="n">luminance</span><span class="p">,</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">temperature</span>
<span class="kn">from</span> <span class="nn">.skymodel</span> <span class="k">import</span> <span class="n">calc_sky_temperature</span>
<span class="kn">from</span> <span class="nn">.futil</span> <span class="k">import</span> <span class="n">write_to_file</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">readmode</span> <span class="o">=</span> <span class="s1">&#39;rb&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">izip</span> <span class="k">as</span> <span class="nb">zip</span>  <span class="c1"># python 2</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">xrange</span> <span class="o">=</span> <span class="nb">range</span>  <span class="c1"># python 3</span>
    <span class="n">readmode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>


<div class="viewcode-block" id="EPW"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW">[docs]</a><span class="k">class</span> <span class="nc">EPW</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An EPW object containing all of the data of an .epw file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path: Local file address to an .epw file.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * location</span>
<span class="sd">        * annual_heating_design_day_996</span>
<span class="sd">        * annual_heating_design_day_990</span>
<span class="sd">        * annual_cooling_design_day_004</span>
<span class="sd">        * annual_cooling_design_day_010</span>
<span class="sd">        * heating_design_condition_dictionary</span>
<span class="sd">        * cooling_design_condition_dictionary</span>
<span class="sd">        * extreme_design_condition_dictionary</span>
<span class="sd">        * extreme_hot_weeks</span>
<span class="sd">        * extreme_cold_weeks</span>
<span class="sd">        * typical_weeks</span>
<span class="sd">        * monthly_ground_temperature</span>
<span class="sd">        * header</span>

<span class="sd">        * years</span>
<span class="sd">        * dry_bulb_temperature</span>
<span class="sd">        * dew_point_temperature</span>
<span class="sd">        * relative_humidity</span>
<span class="sd">        * atmospheric_station_pressure</span>
<span class="sd">        * extraterrestrial_horizontal_radiation</span>
<span class="sd">        * extraterrestrial_direct_normal_radiation</span>
<span class="sd">        * horizontal_infrared_radiation_intensity</span>
<span class="sd">        * global_horizontal_radiation</span>
<span class="sd">        * direct_normal_radiation</span>
<span class="sd">        * diffuse_horizontal_radiation</span>
<span class="sd">        * global_horizontal_illuminance</span>
<span class="sd">        * direct_normal_illuminance</span>
<span class="sd">        * diffuse_horizontal_illuminance</span>
<span class="sd">        * zenith_luminance</span>
<span class="sd">        * wind_direction</span>
<span class="sd">        * wind_speed</span>
<span class="sd">        * total_sky_cover</span>
<span class="sd">        * opaque_sky_cover</span>
<span class="sd">        * visibility</span>
<span class="sd">        * ceiling_height</span>
<span class="sd">        * present_weather_observation</span>
<span class="sd">        * present_weather_codes</span>
<span class="sd">        * precipitable_water</span>
<span class="sd">        * aerosol_optical_depth</span>
<span class="sd">        * snow_depth</span>
<span class="sd">        * days_since_last_snowfall</span>
<span class="sd">        * albedo</span>
<span class="sd">        * liquid_precipitation_depth</span>
<span class="sd">        * liquid_precipitation_quantity</span>
<span class="sd">        * sky_temperature</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initalize an EPW object from from a local .epw file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_header_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_data_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_ip</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># track if collections have been coverted to IP</span>

        <span class="c1"># placeholders for the EPW data that will be imported</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_hot_weeks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_cold_weeks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_typical_weeks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_leap_year</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_start</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_end</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comments_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comments_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span> <span class="o">=</span> <span class="mi">35</span>  <span class="c1"># it is 35 for TMY3 files</span>

<div class="viewcode-block" id="EPW.from_missing_values"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.from_missing_values">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_missing_values</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">is_leap_year</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initalize an EPW object with all data missing or empty.</span>

<span class="sd">        Note that this classmethod is intended for workflows where one plans</span>
<span class="sd">        to set all of the data within the EPW object.  The EPW file written</span>
<span class="sd">        out from the use of this method is not simulate-abe or useful since</span>
<span class="sd">        all hourly data slots just possess the missing value for that data</span>
<span class="sd">        type. To obtain a EPW that is simulate-able in EnergyPlus, one must</span>
<span class="sd">        at least set the following properties:</span>

<span class="sd">        * location</span>
<span class="sd">        * dry_bulb_temperature</span>
<span class="sd">        * dew_point_temperature</span>
<span class="sd">        * relative_humidity</span>
<span class="sd">        * atmospheric_station_pressure</span>
<span class="sd">        * direct_normal_radiation</span>
<span class="sd">        * diffuse_horizontal_radiation</span>
<span class="sd">        * wind_direction</span>
<span class="sd">        * wind_speed</span>
<span class="sd">        * total_sky_cover</span>
<span class="sd">        * opaque_sky_cover or horizontal_infrared_radiation_intensity</span>

<span class="sd">        Args:</span>
<span class="sd">            is_leap_year: A boolean to set whether the EPW object is for a leap year.</span>

<span class="sd">        Usage:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from ladybug.epw import EPW</span>
<span class="sd">            from ladybug.location import Location</span>
<span class="sd">            epw = EPW.from_missing_values()</span>
<span class="sd">            epw.location = Location(&#39;Denver Golden&#39;,&#39;CO&#39;,&#39;USA&#39;,39.74,-105.18,-7.0,1829.0)</span>
<span class="sd">            epw.dry_bulb_temperature.values = [20] * 8760</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the class with all data missing</span>
        <span class="n">epw_obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_leap_year</span> <span class="o">=</span> <span class="n">is_leap_year</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_location</span> <span class="o">=</span> <span class="n">Location</span><span class="p">()</span>

        <span class="c1"># create an annual analysis period</span>
        <span class="n">analysis_period</span> <span class="o">=</span> <span class="n">AnalysisPeriod</span><span class="p">(</span><span class="n">is_leap_year</span><span class="o">=</span><span class="n">is_leap_year</span><span class="p">)</span>

        <span class="c1"># create headers and an empty list for each field in epw file</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">field_number</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">epw_obj</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">EPWFields</span><span class="o">.</span><span class="n">field_by_number</span><span class="p">(</span><span class="n">field_number</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span>
                            <span class="n">analysis_period</span><span class="o">=</span><span class="n">analysis_period</span><span class="p">)</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="c1"># fill in missing datetime values and uncertainty flags.</span>
        <span class="n">uncertainty</span> <span class="o">=</span> <span class="s1">&#39;?9?9?9?9E0?9?9?9?9?9?9?9?9?9?9?9?9?9?9?9*9*9?9?9?9&#39;</span>
        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">analysis_period</span><span class="o">.</span><span class="n">datetimes</span><span class="p">:</span>
            <span class="n">hr</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">24</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>

        <span class="c1"># generate missing hourly data</span>
        <span class="n">calc_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">analysis_period</span><span class="o">.</span><span class="n">datetimes</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field_number</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">epw_obj</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">EPWFields</span><span class="o">.</span><span class="n">field_by_number</span><span class="p">(</span><span class="n">field_number</span><span class="p">)</span>
            <span class="n">mis_val</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">missing</span> <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">missing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">calc_length</span><span class="p">):</span>
                <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mis_val</span><span class="p">)</span>

        <span class="c1"># finally, build the data collection objects from the headers and data</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">epw_obj</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">HourlyContinuousCollection</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_header_loaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_data_loaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">epw_obj</span></div>

<div class="viewcode-block" id="EPW.from_dict"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create EPW from a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: A python dictionary in the following format</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">                {</span>
<span class="sd">                &quot;location&quot;: {} ,  # ladybug location schema</span>
<span class="sd">                &quot;data_collections&quot;: [],  # list of hourly annual hourly data collection</span>
<span class="sd">                    # schemas for each of the 35 fields within the EPW file.</span>
<span class="sd">                &quot;metadata&quot;: {},  # dict of metadata assigned to all data collections</span>
<span class="sd">                &quot;heating_dict&quot;: {},  # dict containing heating design conditions</span>
<span class="sd">                &quot;cooling_dict&quot;: {},  # dict containing cooling design conditions</span>
<span class="sd">                &quot;extremes_dict&quot;: {},  # dict containing extreme design conditions</span>
<span class="sd">                &quot;extreme_hot_weeks&quot;: {},  # dict with values of week-long ladybug</span>
<span class="sd">                    # analysis period schemas signifying extreme hot weeks.</span>
<span class="sd">                &quot;extreme_cold_weeks&quot;: {},  # dict with values of week-long ladybug</span>
<span class="sd">                    # analysis period schemas signifying extreme cold weeks.</span>
<span class="sd">                &quot;typical_weeks&quot;: {},  # dict with values of week-long ladybug</span>
<span class="sd">                    # analysis period schemas signifying typical weeks.</span>
<span class="sd">                &quot;monthly_ground_temps&quot;: {},  # dict with keys as floats signifying</span>
<span class="sd">                    # depths in meters below ground and values of monthly</span>
<span class="sd">                    # collection schema</span>
<span class="sd">                &quot;is_ip&quot;: False  # Boolean // denote whether the data is in IP units</span>
<span class="sd">                &quot;is_leap_year&quot;: False  # Boolean, denote whether data is for</span>
<span class="sd">                                       # a leap year</span>
<span class="sd">                &quot;daylight_savings_start&quot;: 0,  # signify when daylight savings starts</span>
<span class="sd">                                              # or 0 for no daylight savings</span>
<span class="sd">                &quot;daylight_savings_end&quot; 0,  # signify when daylight savings ends</span>
<span class="sd">                                           # or 0 for no daylight savings</span>
<span class="sd">                &quot;comments_1&quot;: &quot;&quot;  # String, epw comments</span>
<span class="sd">                &quot;comments_2&quot;: &quot;&quot;  # String, epw comments</span>
<span class="sd">                }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the class with all data missing</span>
        <span class="n">epw_obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_header_loaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_data_loaded</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Check required and optional keys</span>
        <span class="n">required_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;data_collections&#39;</span><span class="p">)</span>
        <span class="n">option_keys_dict</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;heating_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;cooling_dict&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;extremes_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;extreme_hot_weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;extreme_cold_weeks&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;typical_weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly_ground_temps&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">required_keys</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;Required key &quot;</span><span class="si">{}</span><span class="s1">&quot; is missing!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_collections&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">epw_obj</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">,</span> \
            <span class="s1">&#39;The number of data_collections must be </span><span class="si">{}</span><span class="s1">. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">epw_obj</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_collections&#39;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">option_keys_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Set the required properties of the EPW object.</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_location</span> <span class="o">=</span> <span class="n">Location</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">])</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">HourlyContinuousCollection</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
                         <span class="k">for</span> <span class="n">dc</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_collections&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="s1">&#39;is_leap_year&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_leap_year</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_leap_year&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;is_ip&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_ip</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_ip&#39;</span><span class="p">]</span>

        <span class="c1"># Check that the required properties all make sense.</span>
        <span class="k">for</span> <span class="n">dc</span> <span class="ow">in</span> <span class="n">epw_obj</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">HourlyContinuousCollection</span><span class="p">),</span> <span class="s1">&#39;data_collections must &#39;</span> \
                <span class="s1">&#39;be of HourlyContinuousCollection schema. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dc</span><span class="p">))</span>
            <span class="k">assert</span> <span class="n">dc</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">analysis_period</span><span class="o">.</span><span class="n">is_annual</span><span class="p">,</span> <span class="s1">&#39;data_collections &#39;</span> \
                <span class="s1">&#39;analysis_period must be annual.&#39;</span>
            <span class="k">assert</span> <span class="n">dc</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">analysis_period</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">==</span> <span class="n">epw_obj</span><span class="o">.</span><span class="n">_is_leap_year</span><span class="p">,</span> \
                <span class="s1">&#39;data_collections is_leap_year is not aligned with that of the EPW.&#39;</span>

        <span class="c1"># Set all of the header properties if they exist in the dictionary.</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">heating_design_condition_dictionary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;heating_dict&#39;</span><span class="p">]</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">cooling_design_condition_dictionary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;cooling_dict&#39;</span><span class="p">]</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">extreme_design_condition_dictionary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;extremes_dict&#39;</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">_dedict</span><span class="p">(</span><span class="n">parent_dict</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parent_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new_dict</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">extreme_hot_weeks</span> <span class="o">=</span> <span class="n">_dedict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;extreme_hot_weeks&#39;</span><span class="p">],</span> <span class="n">AnalysisPeriod</span><span class="p">)</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">extreme_cold_weeks</span> <span class="o">=</span> <span class="n">_dedict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;extreme_cold_weeks&#39;</span><span class="p">],</span> <span class="n">AnalysisPeriod</span><span class="p">)</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">typical_weeks</span> <span class="o">=</span> <span class="n">_dedict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;typical_weeks&#39;</span><span class="p">],</span> <span class="n">AnalysisPeriod</span><span class="p">)</span>
        <span class="n">epw_obj</span><span class="o">.</span><span class="n">monthly_ground_temperature</span> <span class="o">=</span> <span class="n">_dedict</span><span class="p">(</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_ground_temps&#39;</span><span class="p">],</span> <span class="n">MonthlyCollection</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;daylight_savings_start&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">daylight_savings_start</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daylight_savings_start&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;daylight_savings_end&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">daylight_savings_end</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daylight_savings_end&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;comments_1&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">comments_1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;comments_1&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;comments_2&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">epw_obj</span><span class="o">.</span><span class="n">comments_2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;comments_2&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">epw_obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get path to epw file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_header_loaded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if location data is loaded.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_header_loaded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_data_loaded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if weather data is loaded.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_data_loaded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the data collections of this file are in IP units.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ip</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return location data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location</span>

    <span class="nd">@location</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">Location</span><span class="p">),</span> <span class="s1">&#39;location&#39;</span> \
            <span class="s1">&#39;must be a Location object. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">loc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_location</span> <span class="o">=</span> <span class="n">loc</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dictionary of metadata written to DataCollection headers.</span>

<span class="sd">        Keys typically include &quot;source&quot;, &quot;country&quot;, and &quot;city&quot;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta_d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meta_d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s1">&#39;metadata&#39;</span> \
            <span class="s1">&#39;must be a dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">meta_d</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">meta_d</span>
        <span class="k">for</span> <span class="n">coll</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">coll</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">meta_d</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annual_heating_design_day_996</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A design day object representing the annual 99.6% heating design day.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_station_pressure</span><span class="o">.</span><span class="n">average</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">avg_press</span> <span class="o">==</span> <span class="mi">999999</span> <span class="k">else</span> <span class="n">avg_press</span>
            <span class="k">return</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">from_ashrae_dict_heating</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">avg_press</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annual_heating_design_day_990</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A design day object representing the annual 99.0% heating design day.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_station_pressure</span><span class="o">.</span><span class="n">average</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">avg_press</span> <span class="o">==</span> <span class="mi">999999</span> <span class="k">else</span> <span class="n">avg_press</span>
            <span class="k">return</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">from_ashrae_dict_heating</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">avg_press</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annual_cooling_design_day_004</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A design day object representing the annual 0.4% cooling design day.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_station_pressure</span><span class="o">.</span><span class="n">average</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">avg_press</span> <span class="o">==</span> <span class="mi">999999</span> <span class="k">else</span> <span class="n">avg_press</span>
            <span class="k">return</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">from_ashrae_dict_cooling</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">avg_press</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annual_cooling_design_day_010</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A design day object representing the annual 1.0% cooling design day.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atmospheric_station_pressure</span><span class="o">.</span><span class="n">average</span>
            <span class="n">avg_press</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">avg_press</span> <span class="o">==</span> <span class="mi">999999</span> <span class="k">else</span> <span class="n">avg_press</span>
            <span class="k">return</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">from_ashrae_dict_cooling</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">avg_press</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">heating_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dictionary with ASHRAE HOF Climate Design Data for heating conditions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span>

    <span class="nd">@heating_design_condition_dictionary</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">heating_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">des_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_des_dict_check</span><span class="p">(</span><span class="n">des_dict</span><span class="p">,</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">heating_keys</span><span class="p">,</span>
                             <span class="s1">&#39;heating_design_condition_dictionary&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span> <span class="o">=</span> <span class="n">des_dict</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cooling_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dictionary with ASHRAE HOF Climate Design Data for cooling conditions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span>

    <span class="nd">@cooling_design_condition_dictionary</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cooling_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">des_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_des_dict_check</span><span class="p">(</span><span class="n">des_dict</span><span class="p">,</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">cooling_keys</span><span class="p">,</span>
                             <span class="s1">&#39;cooling_design_condition_dictionary&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span> <span class="o">=</span> <span class="n">des_dict</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extreme_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dictionary with ASHRAE HOF Climate Design Data for extreme conditions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span>

    <span class="nd">@extreme_design_condition_dictionary</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">extreme_design_condition_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">des_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_des_dict_check</span><span class="p">(</span><span class="n">des_dict</span><span class="p">,</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">extreme_keys</span><span class="p">,</span>
                             <span class="s1">&#39;extreme_design_condition_dictionary&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span> <span class="o">=</span> <span class="n">des_dict</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extreme_cold_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary with AnalysisPeriods for the coldest weeks within the EPW.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_cold_weeks</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_cold_weeks</span>

    <span class="nd">@extreme_cold_weeks</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">extreme_cold_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weeks_check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;extreme_cold_weeks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_cold_weeks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extreme_hot_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary with AnalysisPeriods for the hottest week within the EPW.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_hot_weeks</span>

    <span class="nd">@extreme_hot_weeks</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">extreme_hot_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weeks_check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;extreme_hot_weeks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_hot_weeks</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">typical_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary with AnalysisPeriods for the typical weeks within the EPW.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_typical_weeks</span>

    <span class="nd">@typical_weeks</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">typical_weeks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weeks_check</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;typical_weeks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_typical_weeks</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">monthly_ground_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a dictionary of Mothly Data collections.</span>

<span class="sd">        The keys of this dictionary are the depths at which each set</span>
<span class="sd">        of temperatures occurrs.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span>

    <span class="nd">@monthly_ground_temperature</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">monthly_ground_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s1">&#39;monthly_ground_temperature&#39;</span> \
            <span class="s1">&#39; must be an OrderedDict. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">MonthlyCollection</span><span class="p">),</span> <span class="s1">&#39;monthly_ground_temperature&#39;</span> \
                    <span class="s1">&#39; must contain MonthlyCollection objects. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_leap_year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean to denote whether the EPW is a leap year or not.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_leap_year</span>

    <span class="k">def</span> <span class="nf">_load_header_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if data is loaded and, if not load it.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_header_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">(</span><span class="n">import_header_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_des_dict_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">des_dict</span><span class="p">,</span> <span class="n">req_keys</span><span class="p">,</span> <span class="n">cond_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if an input design condition dictionary is acceptable.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">des_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span> \
            <span class="s1">&#39; must be a dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cond_name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">des_dict</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">des_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">input_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">des_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">req_keys</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">input_keys</span><span class="p">,</span> <span class="s1">&#39;Required key &quot;</span><span class="si">{}</span><span class="s1">&quot; was not found in &#39;</span> \
                    <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cond_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_weeks_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">week_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if input for the typical/extreme weeks of the header is correct.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span> \
            <span class="s1">&#39; must be an OrderedDict. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">week_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">AnalysisPeriod</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> dictionary must contain&#39;</span> \
                    <span class="s1">&#39; AnalysisPeriod objects. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">week_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">doys_int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> AnalysisPeriod must be for&#39;</span>\
                    <span class="s1">&#39; a week.  Got AnalysisPeriod for </span><span class="si">{}</span><span class="s1"> days.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">week_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_import_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">import_header_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Import data from an epw file.</span>

<span class="sd">        Hourly data will be saved in self.data and the various header data</span>
<span class="sd">        will be saved in the properties above.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># perform checks on the file before opening it.</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span><span class="p">),</span> <span class="s1">&#39;Cannot find an epw file at </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;epw&#39;</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is not an .epw file. </span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;It does not possess the .epw file extension.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_path</span><span class="p">,</span> <span class="n">readmode</span><span class="p">)</span> <span class="k">as</span> <span class="n">epwin</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">epwin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">original_header_load</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_header_loaded</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_header_loaded</span><span class="p">:</span>
                <span class="c1"># import location data</span>
                <span class="c1"># first line has location data - Here is an example</span>
                <span class="c1"># LOCATION,Denver Golden Nr,CO,USA,TMY3,724666,39.74,-105.18,-7.0,1829.0</span>
                <span class="n">location_data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span> <span class="o">=</span> <span class="n">Location</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> \
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">time_zone</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">location_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>

                <span class="c1"># asemble a dictionary of metadata</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
                    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">country</span><span class="p">,</span>
                    <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_location</span><span class="o">.</span><span class="n">city</span>
                <span class="p">}</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_header</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">epwin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>

                <span class="c1"># parse the heating, cooling and extreme design conditions.</span>
                <span class="n">dday_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dday_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">dday_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Heating&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DesignDay</span><span class="o">.</span><span class="n">heating_keys</span><span class="p">,</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">20</span><span class="p">]):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">if</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooling&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DesignDay</span><span class="o">.</span><span class="n">cooling_keys</span><span class="p">,</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span><span class="p">]):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">if</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">53</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Extremes&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">DesignDay</span><span class="o">.</span><span class="n">extreme_keys</span><span class="p">,</span> <span class="n">dday_data</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">70</span><span class="p">]):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

                <span class="c1"># parse typical and extreme periods into analysis periods.</span>
                <span class="n">week_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">num_weeks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">week_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">week_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">st_ind</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_weeks</span><span class="p">):</span>
                    <span class="n">week_dat</span> <span class="o">=</span> <span class="n">week_data</span><span class="p">[</span><span class="n">st_ind</span><span class="p">:</span><span class="n">st_ind</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
                    <span class="n">st_ind</span> <span class="o">+=</span> <span class="mi">4</span>
                    <span class="n">st</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">a_per</span> <span class="o">=</span> <span class="n">AnalysisPeriod</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">23</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">a_per</span> <span class="o">=</span> <span class="n">AnalysisPeriod</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">23</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;Max&#39;</span> <span class="ow">in</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Extreme&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_hot_weeks</span><span class="p">[</span><span class="n">week_dat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a_per</span>
                    <span class="k">elif</span> <span class="s1">&#39;Min&#39;</span> <span class="ow">in</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Extreme&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_extreme_cold_weeks</span><span class="p">[</span><span class="n">week_dat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a_per</span>
                    <span class="k">elif</span> <span class="n">week_dat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Typical&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_typical_weeks</span><span class="p">[</span><span class="n">week_dat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a_per</span>

                <span class="c1"># parse the monthly ground temperatures in the header.</span>
                <span class="n">grnd_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">num_depths</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grnd_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grnd_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">st_ind</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_depths</span><span class="p">):</span>
                    <span class="n">header_meta</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">)</span>  <span class="c1"># copying the metadata dictionary</span>
                    <span class="n">header_meta</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span><span class="p">])</span>
                    <span class="n">header_meta</span><span class="p">[</span><span class="s1">&#39;soil conductivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">header_meta</span><span class="p">[</span><span class="s1">&#39;soil density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="n">header_meta</span><span class="p">[</span><span class="s1">&#39;soil specific heat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
                    <span class="n">grnd_header</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="n">temperature</span><span class="o">.</span><span class="n">GroundTemperature</span><span class="p">(),</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                                         <span class="n">AnalysisPeriod</span><span class="p">(),</span> <span class="n">header_meta</span><span class="p">)</span>
                    <span class="n">grnd_vlas</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span> <span class="o">+</span> <span class="mi">4</span><span class="p">:</span> <span class="n">st_ind</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">grnd_data</span><span class="p">[</span><span class="n">st_ind</span><span class="p">])]</span> <span class="o">=</span> \
                        <span class="n">MonthlyCollection</span><span class="p">(</span><span class="n">grnd_header</span><span class="p">,</span> <span class="n">grnd_vlas</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
                    <span class="n">st_ind</span> <span class="o">+=</span> <span class="mi">16</span>

                <span class="c1"># parse leap year, daylight savings and comments.</span>
                <span class="n">leap_dl_sav</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_leap_year</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">leap_dl_sav</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_start</span> <span class="o">=</span> <span class="n">leap_dl_sav</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_end</span> <span class="o">=</span> <span class="n">leap_dl_sav</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">comments_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">comments_1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comments_1</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">comments_1</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">comments_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">comments_2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comments_2</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">comments_2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_is_header_loaded</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">import_header_only</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="c1"># read first line of data to overwrite the number of fields</span>
            <span class="k">if</span> <span class="n">original_header_load</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
                    <span class="n">epwin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">epwin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)),</span> <span class="mi">35</span><span class="p">)</span>

            <span class="c1"># create an annual analysis period</span>
            <span class="n">analysis_period</span> <span class="o">=</span> <span class="n">AnalysisPeriod</span><span class="p">(</span><span class="n">is_leap_year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_leap_year</span><span class="p">)</span>

            <span class="c1"># create headers and an empty list for each field in epw file</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">field_number</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">EPWFields</span><span class="o">.</span><span class="n">field_by_number</span><span class="p">(</span><span class="n">field_number</span><span class="p">)</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">field</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span>
                                <span class="n">analysis_period</span><span class="o">=</span><span class="n">analysis_period</span><span class="p">,</span>
                                <span class="n">metadata</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">))</span>
                <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="c1"># collect hourly data</span>
            <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">field_number</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                    <span class="n">value_type</span> <span class="o">=</span> <span class="n">EPWFields</span><span class="o">.</span><span class="n">field_by_number</span><span class="p">(</span><span class="n">field_number</span><span class="p">)</span><span class="o">.</span><span class="n">value_type</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">value_type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field_number</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="c1"># failed to convert the value for the specific TypeError</span>
                        <span class="k">if</span> <span class="n">value_type</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field_number</span><span class="p">])))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="n">line</span> <span class="o">=</span> <span class="n">epwin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

            <span class="c1"># if the first value is at 1 AM, move last item to start position</span>
            <span class="k">for</span> <span class="n">field_number</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                <span class="n">point_in_time</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">point_in_time</span>
                <span class="k">if</span> <span class="n">point_in_time</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="c1"># move the last hour to first position</span>
                    <span class="n">last_hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_hour</span><span class="p">)</span>

            <span class="c1"># finally, build the data collection objects from the headers and data</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">HourlyContinuousCollection</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_is_data_loaded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of text representing the full header (the first 8 lines) of the EPW.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_header_check</span><span class="p">()</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span>
        <span class="n">loc_str</span> <span class="o">=</span> <span class="s1">&#39;LOCATION,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">.</span><span class="n">city</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">country</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">station_id</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
            <span class="n">loc</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">time_zone</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">elevation</span><span class="p">)</span>
        <span class="n">winter_found</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">)</span>
        <span class="n">summer_found</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">)</span>
        <span class="n">extreme_found</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">winter_found</span> <span class="ow">and</span> <span class="n">summer_found</span> <span class="ow">and</span> <span class="n">extreme_found</span><span class="p">:</span>
            <span class="n">des_str</span> <span class="o">=</span> <span class="s1">&#39;DESIGN CONDITIONS,1,Climate Design Data 2009 ASHRAE Handbook,,&#39;</span>
            <span class="n">des_str</span> <span class="o">=</span> <span class="n">des_str</span> <span class="o">+</span> <span class="s1">&#39;Heating,</span><span class="si">{}</span><span class="s1">,Cooling,</span><span class="si">{}</span><span class="s1">,Extremes,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_heating_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">heating_keys</span><span class="p">]),</span>
                <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_cooling_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">cooling_keys</span><span class="p">]),</span>
                <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_extremes_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">DesignDay</span><span class="o">.</span><span class="n">extreme_keys</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">des_str</span> <span class="o">=</span> <span class="s1">&#39;DESIGN CONDITIONS,0</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">weeks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extreme_hot_weeks</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">wk_name</span><span class="p">,</span> <span class="n">a_per</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extreme_hot_weeks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">weeks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_week</span><span class="p">(</span><span class="n">wk_name</span><span class="p">,</span> <span class="s1">&#39;Extreme&#39;</span><span class="p">,</span> <span class="n">a_per</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extreme_cold_weeks</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">wk_name</span><span class="p">,</span> <span class="n">a_per</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extreme_cold_weeks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">weeks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_week</span><span class="p">(</span><span class="n">wk_name</span><span class="p">,</span> <span class="s1">&#39;Extreme&#39;</span><span class="p">,</span> <span class="n">a_per</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typical_weeks</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">wk_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typical_weeks</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">a_per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typical_weeks</span><span class="p">[</span><span class="n">wk_name</span><span class="p">]</span>
                <span class="n">weeks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_week</span><span class="p">(</span><span class="n">wk_name</span><span class="p">,</span> <span class="s1">&#39;Typical&#39;</span><span class="p">,</span> <span class="n">a_per</span><span class="p">))</span>
        <span class="n">week_str</span> <span class="o">=</span> <span class="s1">&#39;TYPICAL/EXTREME PERIODS,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weeks</span><span class="p">),</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">weeks</span><span class="p">))</span>
        <span class="n">grnd_st</span> <span class="o">=</span> <span class="s1">&#39;GROUND TEMPERATURES,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">grnd_st</span> <span class="o">=</span> <span class="n">grnd_st</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_grndt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_monthly_ground_temps</span><span class="p">[</span><span class="n">depth</span><span class="p">]))</span>
        <span class="n">grnd_st</span> <span class="o">=</span> <span class="n">grnd_st</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">leap_yr</span> <span class="o">=</span> <span class="s1">&#39;Yes&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_leap_year</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="s1">&#39;No&#39;</span>
        <span class="n">leap_str</span> <span class="o">=</span> <span class="s1">&#39;HOLIDAYS/DAYLIGHT SAVINGS,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">leap_yr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_end</span><span class="p">)</span>
        <span class="n">c_str1</span> <span class="o">=</span> <span class="s1">&#39;COMMENTS 1,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comments_1</span><span class="p">)</span>
        <span class="n">c_str2</span> <span class="o">=</span> <span class="s1">&#39;COMMENTS 2,</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comments_2</span><span class="p">)</span>
        <span class="n">data_str</span> <span class="o">=</span> <span class="s1">&#39;DATA PERIODS,1,1,Data,Sunday, 1/ 1,12/31</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">loc_str</span><span class="p">,</span> <span class="n">des_str</span><span class="p">,</span> <span class="n">week_str</span><span class="p">,</span> <span class="n">grnd_st</span><span class="p">,</span> <span class="n">leap_str</span><span class="p">,</span> <span class="n">c_str1</span><span class="p">,</span> <span class="n">c_str2</span><span class="p">,</span> <span class="n">data_str</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_format_week</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">a_per</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format an AnalysisPeriod into string for the EPW header.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">a_per</span><span class="o">.</span><span class="n">st_month</span><span class="p">,</span> <span class="n">a_per</span><span class="o">.</span><span class="n">st_day</span><span class="p">,</span>
                                          <span class="n">a_per</span><span class="o">.</span><span class="n">end_month</span><span class="p">,</span> <span class="n">a_per</span><span class="o">.</span><span class="n">end_day</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_format_grndt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format monthly ground data collection into string for the EPW header.&quot;&quot;&quot;</span>
        <span class="n">monthly_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">data_c</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;soil conductivity&#39;</span><span class="p">],</span>
            <span class="n">data_c</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;soil density&#39;</span><span class="p">],</span>
            <span class="n">data_c</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;soil specific heat&#39;</span><span class="p">],</span>
            <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_c</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">monthly_str</span>

<div class="viewcode-block" id="EPW.save"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save epw object as an epw file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: A string representing the path to write the epw file to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># load data if it&#39;s  not loaded convert to SI if it is in IP</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_data_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">()</span>
        <span class="n">originally_ip</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ip</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_si</span><span class="p">()</span>
            <span class="n">originally_ip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># write the file</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># if the first value is at 1AM, move first item to end position</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                <span class="n">point_in_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">point_in_time</span>
                <span class="k">if</span> <span class="n">point_in_time</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">first_hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_hour</span><span class="p">)</span>

            <span class="n">annual_a_per</span> <span class="o">=</span> <span class="n">AnalysisPeriod</span><span class="p">(</span><span class="n">is_leap_year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_leap_year</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">annual_a_per</span><span class="o">.</span><span class="n">datetimes</span><span class="p">)):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                    <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">hour</span><span class="p">]))</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="c1"># cleaning up</span>
            <span class="n">length_error_msg</span> <span class="o">=</span> <span class="s1">&#39;Data length is not for a full year and cannot be &#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;saved as an EPW file.&#39;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">length_error_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="n">write_to_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">file_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="c1"># move last item to start position for fields on the hour</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">):</span>
                <span class="n">point_in_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">point_in_time</span>
                <span class="k">if</span> <span class="n">point_in_time</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">last_hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_hour</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">originally_ip</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_ip</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="EPW.convert_to_ip"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.convert_to_ip">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert all Data Collections of this EPW object to IP units.</span>

<span class="sd">        This is useful when one knows that all graphics produced from this</span>
<span class="sd">        EPW should be in Imperial units.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_data_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ip</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">coll</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="n">coll</span><span class="o">.</span><span class="n">convert_to_ip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_ip</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="EPW.convert_to_si"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.convert_to_si">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_si</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert all Data Collections of this EPW object to SI units.</span>

<span class="sd">        This is useful when one needs to convert the EPW back to SI units</span>
<span class="sd">        from imperial units for processes like computing thermal comfort</span>
<span class="sd">        from EPW data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_data_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ip</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">coll</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="n">coll</span><span class="o">.</span><span class="n">convert_to_si</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_ip</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_get_data_by_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a data field by field number.</span>

<span class="sd">        This is a useful method to get the values for fields that Ladybug</span>
<span class="sd">        currently doesn&#39;t import by default. You can find list of fields by typing</span>
<span class="sd">        EPWFields.fields</span>

<span class="sd">        Args:</span>
<span class="sd">            field_number: a value between 0 to 34 for different available epw fields.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An annual Ladybug list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_data_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">()</span>

        <span class="c1"># check input data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">field_number</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Field number should be between 0-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_of_fields</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">field_number</span><span class="p">]</span>

<div class="viewcode-block" id="EPW.import_data_by_field"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.import_data_by_field">[docs]</a>    <span class="k">def</span> <span class="nf">import_data_by_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an annual data collection for any field_number in epw file.</span>

<span class="sd">        This is a useful method to get the values for fields that Ladybug currently</span>
<span class="sd">        doesn&#39;t import by default. You can find list of fields by typing</span>
<span class="sd">        EPWFields.fields</span>

<span class="sd">        Args:</span>
<span class="sd">            field_number: A value between 0 to 34 for different available epw fields.</span>

<span class="sd">                *   0 Year</span>
<span class="sd">                *   1 Month</span>
<span class="sd">                *   2 Day</span>
<span class="sd">                *   3 Hour</span>
<span class="sd">                *   4 Minute</span>
<span class="sd">                *   5 -</span>
<span class="sd">                *   6 Dry Bulb Temperature</span>
<span class="sd">                *   7 Dew Point Temperature</span>
<span class="sd">                *   8 Relative Humidity</span>
<span class="sd">                *   9 Atmospheric Station Pressure</span>
<span class="sd">                *   10 Extraterrestrial Horizontal Radiation</span>
<span class="sd">                *   11 Extraterrestrial Direct Normal Radiation</span>
<span class="sd">                *   12 Horizontal Infrared Radiation Intensity</span>
<span class="sd">                *   13 Global Horizontal Radiation</span>
<span class="sd">                *   14 Direct Normal Radiation</span>
<span class="sd">                *   15 Diffuse Horizontal Radiation</span>
<span class="sd">                *   16 Global Horizontal Illuminance</span>
<span class="sd">                *   17 Direct Normal Illuminance</span>
<span class="sd">                *   18 Diffuse Horizontal Illuminance</span>
<span class="sd">                *   19 Zenith Luminance</span>
<span class="sd">                *   20 Wind Direction</span>
<span class="sd">                *   21 Wind Speed</span>
<span class="sd">                *   22 Total Sky Cover</span>
<span class="sd">                *   23 Opaque Sky Cover</span>
<span class="sd">                *   24 Visibility</span>
<span class="sd">                *   25 Ceiling Height</span>
<span class="sd">                *   26 Present Weather Observation</span>
<span class="sd">                *   27 Present Weather Codes</span>
<span class="sd">                *   28 Precipitable Water</span>
<span class="sd">                *   29 Aerosol Optical Depth</span>
<span class="sd">                *   30 Snow Depth</span>
<span class="sd">                *   31 Days Since Last Snowfall</span>
<span class="sd">                *   32 Albedo</span>
<span class="sd">                *   33 Liquid Precipitation Depth</span>
<span class="sd">                *   34 Liquid Precipitation Quantity</span>

<span class="sd">        Returns:</span>
<span class="sd">            An annual Ladybug list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="n">field_number</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">years</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return years as a Ladybug Data Collection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dry_bulb_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Dry Bulb Temperature as a Ladybug Data Collection.</span>

<span class="sd">        This is the dry bulb temperature in C at the time indicated. Note that</span>
<span class="sd">        this is a full numeric field (i.e. 23.6) and not an integer representation</span>
<span class="sd">        with tenths. Valid values range from -70C to 70 C. Missing value for this</span>
<span class="sd">        field is 99.9.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dew_point_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">u</span><span class="sd">&quot;&quot;&quot;Return annual Dew Point Temperature as a Ladybug Data Collection.</span>

<span class="sd">        This is the dew point temperature in C at the time indicated. Note that this is</span>
<span class="sd">        a full numeric field (i.e. 23.6) and not an integer representation with tenths.</span>
<span class="sd">        Valid values range from -70 C to 70 C. Missing value for this field is 99.9</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">relative_humidity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">u</span><span class="sd">&quot;&quot;&quot;Return annual Relative Humidity as a Ladybug Data Collection.</span>

<span class="sd">        This is the Relative Humidity in percent at the time indicated. Valid values</span>
<span class="sd">        range from 0% to 110%. Missing value for this field is 999.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">atmospheric_station_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Atmospheric Station Pressure as a Ladybug Data Collection.</span>

<span class="sd">        This is the station pressure in Pa at the time indicated. Valid values range</span>
<span class="sd">        from 31,000 to 120,000. (These values were chosen from the standard barometric</span>
<span class="sd">        pressure for all elevations of the World). Missing value for this field is 999999</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extraterrestrial_horizontal_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Extraterrestrial Horizontal Radiation as a Ladybug Data Collection.</span>

<span class="sd">        This is the Extraterrestrial Horizontal Radiation in Wh/m2. It is not currently</span>
<span class="sd">        used in EnergyPlus calculations. It should have a minimum value of 0; missing</span>
<span class="sd">        value for this field is 9999.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extraterrestrial_direct_normal_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Extraterrestrial Direct Normal Radiation as a Ladybug Data Collection.</span>

<span class="sd">        This is the Extraterrestrial Direct Normal Radiation in Wh/m2. (Amount of solar</span>
<span class="sd">        radiation in Wh/m2 received on a surface normal to the rays of the sun at the top</span>
<span class="sd">        of the atmosphere during the number of minutes preceding the time indicated).</span>
<span class="sd">        It is not currently used in EnergyPlus calculations. It should have a minimum</span>
<span class="sd">        value of 0; missing value for this field is 9999.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">horizontal_infrared_radiation_intensity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Horizontal Infrared Radiation Intensity as a Ladybug Data Collection.</span>

<span class="sd">        This is the Horizontal Infrared Radiation Intensity in W/m2. If it is missing,</span>
<span class="sd">        it is calculated from the Opaque Sky Cover field as shown in the following</span>
<span class="sd">        explanation. It should have a minimum value of 0; missing value for this field</span>
<span class="sd">        is 9999.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_horizontal_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Global Horizontal Radiation as a Ladybug Data Collection.</span>

<span class="sd">        This is the Global Horizontal Radiation in Wh/m2. (Total amount of direct and</span>
<span class="sd">        diffuse solar radiation in Wh/m2 received on a horizontal surface during the</span>
<span class="sd">        number of minutes preceding the time indicated.) It is not currently used in</span>
<span class="sd">        EnergyPlus calculations. It should have a minimum value of 0; missing value</span>
<span class="sd">        for this field is 9999.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">direct_normal_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Direct Normal Radiation as a Ladybug Data Collection.</span>

<span class="sd">        This is the Direct Normal Radiation in Wh/m2. (Amount of solar radiation in</span>
<span class="sd">        Wh/m2 received directly from the solar disk on a surface perpendicular to the</span>
<span class="sd">        sun&#39;s rays, during the number of minutes preceding the time indicated.) If the</span>
<span class="sd">        field is missing ( &gt;= 9999) or invalid ( &lt; 0), it is set to 0. Counts of such</span>
<span class="sd">        missing values are totaled and presented at the end of the runperiod.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">diffuse_horizontal_radiation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Diffuse Horizontal Radiation as a Ladybug Data Collection.</span>

<span class="sd">        This is the Diffuse Horizontal Radiation in Wh/m2. (Amount of solar radiation in</span>
<span class="sd">        Wh/m2 received from the sky (excluding the solar disk) on a horizontal surface</span>
<span class="sd">        during the number of minutes preceding the time indicated.) If the field is</span>
<span class="sd">        missing ( &gt;= 9999) or invalid ( &lt; 0), it is set to 0. Counts of such missing</span>
<span class="sd">        values are totaled and presented at the end of the runperiod</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_horizontal_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Global Horizontal Illuminance as a Ladybug Data Collection.</span>

<span class="sd">        This is the Global Horizontal Illuminance in lux. (Average total amount of</span>
<span class="sd">        direct and diffuse illuminance in hundreds of lux received on a horizontal</span>
<span class="sd">        surface during the number of minutes preceding the time indicated.) It is not</span>
<span class="sd">        currently used in EnergyPlus calculations. It should have a minimum value of 0;</span>
<span class="sd">        missing value for this field is 999999 and will be considered missing if greater</span>
<span class="sd">        than or equal to 999900.</span>
<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">direct_normal_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Direct Normal Illuminance as a Ladybug Data Collection.</span>

<span class="sd">        This is the Direct Normal Illuminance in lux. (Average amount of illuminance in</span>
<span class="sd">        hundreds of lux received directly from the solar disk on a surface perpendicular</span>
<span class="sd">        to the sun&#39;s rays, during the number of minutes preceding the time indicated.)</span>
<span class="sd">        It is not currently used in EnergyPlus calculations. It should have a minimum</span>
<span class="sd">        value of 0; missing value for this field is 999999 and will be considered missing</span>
<span class="sd">        if greater than or equal to 999900.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">diffuse_horizontal_illuminance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Diffuse Horizontal Illuminance as a Ladybug Data Collection.</span>

<span class="sd">        This is the Diffuse Horizontal Illuminance in lux. (Average amount of illuminance</span>
<span class="sd">        in hundreds of lux received from the sky (excluding the solar disk) on a</span>
<span class="sd">        horizontal surface during the number of minutes preceding the time indicated.)</span>
<span class="sd">        It is not currently used in EnergyPlus calculations. It should have a minimum</span>
<span class="sd">        value of 0; missing value for this field is 999999 and will be considered missing</span>
<span class="sd">        if greater than or equal to 999900.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zenith_luminance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Zenith Luminance as a Ladybug Data Collection.</span>

<span class="sd">        This is the Zenith Illuminance in Cd/m2. (Average amount of luminance at</span>
<span class="sd">        the sky&#39;s zenith in tens of Cd/m2 during the number of minutes preceding</span>
<span class="sd">        the time indicated.) It is not currently used in EnergyPlus calculations.</span>
<span class="sd">        It should have a minimum value of 0; missing value for this field is 9999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wind_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Wind Direction as a Ladybug Data Collection.</span>

<span class="sd">        This is the Wind Direction in degrees where the convention is that North=0.0,</span>
<span class="sd">        East=90.0, South=180.0, West=270.0. (Wind direction in degrees at the time</span>
<span class="sd">        indicated. If calm, direction equals zero.) Values can range from 0 to 360.</span>
<span class="sd">        Missing value is 999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wind_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Wind Speed as a Ladybug Data Collection.</span>

<span class="sd">        This is the wind speed in m/sec. (Wind speed at time indicated.) Values can</span>
<span class="sd">        range from 0 to 40. Missing value is 999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total_sky_cover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Total Sky Cover as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for total sky cover (tenths of coverage). (i.e. 1 is 1/10</span>
<span class="sd">        covered. 10 is total coverage). (Amount of sky dome in tenths covered by clouds</span>
<span class="sd">        or obscuring phenomena at the hour indicated at the time indicated.) Minimum</span>
<span class="sd">        value is 0; maximum value is 10; missing value is 99.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">opaque_sky_cover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Opaque Sky Cover as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for opaque sky cover (tenths of coverage). (i.e. 1 is 1/10</span>
<span class="sd">        covered. 10 is total coverage). (Amount of sky dome in tenths covered by</span>
<span class="sd">        clouds or obscuring phenomena that prevent observing the sky or higher cloud</span>
<span class="sd">        layers at the time indicated.) This is not used unless the field for Horizontal</span>
<span class="sd">        Infrared Radiation Intensity is missing and then it is used to calculate</span>
<span class="sd">        Horizontal Infrared Radiation Intensity. Minimum value is 0; maximum value is</span>
<span class="sd">        10; missing value is 99.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">visibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Visibility as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for visibility in km. (Horizontal visibility at the time</span>
<span class="sd">        indicated.) It is not currently used in EnergyPlus calculations. Missing</span>
<span class="sd">        value is 9999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ceiling_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Ceiling Height as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for ceiling height in m. (77777 is unlimited ceiling height.</span>
<span class="sd">        88888 is cirroform ceiling.) It is not currently used in EnergyPlus calculations.</span>
<span class="sd">        Missing value is 99999</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">present_weather_observation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Present Weather Observation as a Ladybug Data Collection.</span>

<span class="sd">        If the value of the field is 0, then the observed weather codes are taken from</span>
<span class="sd">        the following field. If the value of the field is 9, then &quot;missing&quot; weather is</span>
<span class="sd">        assumed. Since the primary use of these fields (Present Weather Observation and</span>
<span class="sd">        Present Weather Codes) is for rain/wet surfaces, a missing observation field or</span>
<span class="sd">        a missing weather code implies no rain.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">present_weather_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Present Weather Codes as a Ladybug Data Collection.</span>

<span class="sd">        The present weather codes field is assumed to follow the TMY2 conventions for</span>
<span class="sd">        this field. Note that though this field may be represented as numeric (e.g. in</span>
<span class="sd">        the CSV format), it is really a text field of 9 single digits. This convention</span>
<span class="sd">        along with values for each &quot;column&quot; (left to right) is presented in Table 16.</span>
<span class="sd">        Note that some formats (e.g. TMY) does not follow this convention - as much as</span>
<span class="sd">        possible, the present weather codes are converted to this convention during</span>
<span class="sd">        WeatherConverter processing. Also note that the most important fields are those</span>
<span class="sd">        representing liquid precipitation - where the surfaces of the building would be</span>
<span class="sd">        wet. EnergyPlus uses &quot;Snow Depth&quot; to determine if snow is on the ground.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">precipitable_water</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Precipitable Water as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for Precipitable Water in mm. (This is not rain - rain is</span>
<span class="sd">        inferred from the PresWeathObs field but a better result is from the Liquid</span>
<span class="sd">        Precipitation Depth field). It is not currently used in EnergyPlus calculations</span>
<span class="sd">        (primarily due to the unreliability of the reporting of this value). Missing</span>
<span class="sd">        value is 999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aerosol_optical_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Aerosol Optical Depth as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for Aerosol Optical Depth in thousandths. It is not currently</span>
<span class="sd">        used in EnergyPlus calculations. Missing value is .999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">snow_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Snow Depth as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for Snow Depth in cm. This field is used to tell when snow</span>
<span class="sd">        is on the ground and, thus, the ground reflectance may change. Missing value</span>
<span class="sd">        is 999.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">days_since_last_snowfall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Days Since Last Snow Fall as a Ladybug Data Collection.</span>

<span class="sd">        This is the value for Days Since Last Snowfall. It is not currently used in</span>
<span class="sd">        EnergyPlus calculations. Missing value is 99.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">albedo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Albedo values as a Ladybug Data Collection.</span>

<span class="sd">        The ratio (unitless) of reflected solar irradiance to global horizontal</span>
<span class="sd">        irradiance. It is not currently used in EnergyPlus.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_precipitation_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual liquid precipitation depth as a Ladybug Data Collection.</span>

<span class="sd">        The amount of liquid precipitation (mm) observed at the indicated time for the</span>
<span class="sd">        period indicated in the liquid precipitation quantity field. If this value is</span>
<span class="sd">        not missing, then it is used and overrides the &quot;precipitation&quot; flag as rainfall.</span>
<span class="sd">        Conversely, if the precipitation flag shows rain and this field is missing or</span>
<span class="sd">        zero, it is set to 1.5 (mm).</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs\</span>
<span class="sd">/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquid_precipitation_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Liquid Precipitation Quantity as a Ladybug Data Collection.</span>

<span class="sd">        The period of accumulation (hr) for the liquid precipitation depth field.</span>
<span class="sd">        It is not currently used in EnergyPlus.</span>

<span class="sd">        Read more at: https://energyplus.net/sites/all/modules/custom/nrel_custom/\</span>
<span class="sd">pdfs/pdfs_v8.4.0/AuxiliaryPrograms.pdf (Chapter 2.9.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sky_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return annual Sky Temperature as a Ladybug Data Collection.</span>

<span class="sd">        This value in degrees Celcius is derived from the Horizontal Infrared</span>
<span class="sd">        Radiation Intensity in Wh/m2. It represents the long wave radiant</span>
<span class="sd">        temperature of the sky</span>
<span class="sd">        Read more at: https://bigladdersoftware.com/epx/docs/8-9/engineering-reference\</span>
<span class="sd">/climate-calculations.html#energyplus-sky-temperature-calculation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create sky temperature header</span>
        <span class="n">sky_temp_header</span> <span class="o">=</span> <span class="n">Header</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="n">temperature</span><span class="o">.</span><span class="n">SkyTemperature</span><span class="p">(),</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>
                                 <span class="n">analysis_period</span><span class="o">=</span><span class="n">AnalysisPeriod</span><span class="p">(),</span>
                                 <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">)</span>

        <span class="c1"># calculate sy temperature for each hour</span>
        <span class="n">horiz_ir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data_by_field</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">sky_temp_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">calc_sky_temperature</span><span class="p">(</span><span class="n">hir</span><span class="p">)</span> <span class="k">for</span> <span class="n">hir</span> <span class="ow">in</span> <span class="n">horiz_ir</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">HourlyContinuousCollection</span><span class="p">(</span><span class="n">sky_temp_header</span><span class="p">,</span> <span class="n">sky_temp_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_wea_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;place </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">city</span> <span class="o">+</span> \
            <span class="s2">&quot;latitude </span><span class="si">%.2f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">latitude</span> <span class="o">+</span> \
            <span class="s2">&quot;longitude </span><span class="si">%.2f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> \
            <span class="s2">&quot;time_zone </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">time_zone</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span> <span class="o">+</span> \
            <span class="s2">&quot;site_elevation </span><span class="si">%.1f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">elevation</span> <span class="o">+</span> \
            <span class="s2">&quot;weather_data_file_unit 1</span><span class="se">\n</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="EPW.to_wea"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.to_wea">[docs]</a>    <span class="k">def</span> <span class="nf">to_wea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">hoys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write an wea file from the epw file.</span>

<span class="sd">        WEA carries radiation values from epw. Gendaymtx uses these values to</span>
<span class="sd">        generate the sky. For an annual analysis it is identical to using epw2wea.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Full file path for output file.</span>
<span class="sd">            hoys: List of hours of the year. Default is 0-8759.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hoys</span> <span class="o">=</span> <span class="n">hoys</span> <span class="ow">or</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_normal_radiation</span><span class="o">.</span><span class="n">datetimes</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.wea&#39;</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">+=</span> <span class="s1">&#39;.wea&#39;</span>

        <span class="n">originally_ip</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ip</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_si</span><span class="p">()</span>
            <span class="n">originally_ip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># write header</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_wea_header</span><span class="p">()]</span>
        <span class="c1"># write values</span>
        <span class="n">datetimes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_normal_radiation</span><span class="o">.</span><span class="n">datetimes</span>
        <span class="k">for</span> <span class="n">hoy</span> <span class="ow">in</span> <span class="n">hoys</span><span class="p">:</span>
            <span class="n">dir_rad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_normal_radiation</span><span class="p">[</span><span class="n">hoy</span><span class="p">]</span>
            <span class="n">dif_rad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffuse_horizontal_radiation</span><span class="p">[</span><span class="n">hoy</span><span class="p">]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%.3f</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> \
                <span class="o">%</span> <span class="p">(</span><span class="n">datetimes</span><span class="p">[</span><span class="n">hoy</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                   <span class="n">datetimes</span><span class="p">[</span><span class="n">hoy</span><span class="p">]</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
                   <span class="n">datetimes</span><span class="p">[</span><span class="n">hoy</span><span class="p">]</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                   <span class="n">dir_rad</span><span class="p">,</span> <span class="n">dif_rad</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="n">file_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="n">write_to_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">file_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">originally_ip</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_ip</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">file_path</span></div>

<div class="viewcode-block" id="EPW.to_dict"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the EPW to a dictionary.&quot;&quot;&quot;</span>
        <span class="c1"># load data if it&#39;s not loaded</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_data_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_import_data</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">dictify_dict</span><span class="p">(</span><span class="n">base_dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">base_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">new_dict</span>
        <span class="n">hot_wks</span> <span class="o">=</span> <span class="n">dictify_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extreme_hot_weeks</span><span class="p">)</span>
        <span class="n">cold_wks</span> <span class="o">=</span> <span class="n">dictify_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extreme_cold_weeks</span><span class="p">)</span>
        <span class="n">typ_wks</span> <span class="o">=</span> <span class="n">dictify_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typical_weeks</span><span class="p">)</span>
        <span class="n">grnd_temps</span> <span class="o">=</span> <span class="n">dictify_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monthly_ground_temperature</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
            <span class="s1">&#39;data_collections&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dc</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">dc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">],</span>
            <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="s1">&#39;heating_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">heating_design_condition_dictionary</span><span class="p">,</span>
            <span class="s1">&#39;cooling_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooling_design_condition_dictionary</span><span class="p">,</span>
            <span class="s1">&#39;extremes_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extreme_design_condition_dictionary</span><span class="p">,</span>
            <span class="s1">&#39;extreme_hot_weeks&#39;</span><span class="p">:</span> <span class="n">hot_wks</span><span class="p">,</span>
            <span class="s1">&#39;extreme_cold_weeks&#39;</span><span class="p">:</span> <span class="n">cold_wks</span><span class="p">,</span>
            <span class="s1">&#39;typical_weeks&#39;</span><span class="p">:</span> <span class="n">typ_wks</span><span class="p">,</span>
            <span class="s2">&quot;monthly_ground_temps&quot;</span><span class="p">:</span> <span class="n">grnd_temps</span><span class="p">,</span>
            <span class="s2">&quot;is_ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ip</span><span class="p">,</span>
            <span class="s2">&quot;is_leap_year&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_leap_year</span><span class="p">,</span>
            <span class="s2">&quot;daylight_savings_start&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_start</span><span class="p">,</span>
            <span class="s2">&quot;daylight_savings_end&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">daylight_savings_end</span><span class="p">,</span>
            <span class="s2">&quot;comments_1&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">comments_1</span><span class="p">,</span>
            <span class="s2">&quot;comments_2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">comments_2</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s1">&#39;EPW&#39;</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="EPW.ToString"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPW.ToString">[docs]</a>    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrite .NET ToString.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;epw file representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;EPW file Data for [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">city</span></div>


<div class="viewcode-block" id="EPWFields"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPWFields">[docs]</a><span class="k">class</span> <span class="nc">EPWFields</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;EPW weather file fields.</span>

<span class="sd">    Read more at https://energyplus.net/sites/all/modules/custom/nrel_custom/pdfs/\</span>
<span class="sd">pdfs_v8.4.0/AuxiliaryPrograms.pdf</span>
<span class="sd">    (Chapter 2.9.1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fields</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;yr&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;yr&#39;</span>
            <span class="p">},</span>

        <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;mon&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;mon&#39;</span>
            <span class="p">},</span>

        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;day&#39;</span>
            <span class="p">},</span>

        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Hour&#39;</span><span class="p">,</span> <span class="s1">&#39;hr&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;hr&#39;</span>
            <span class="p">},</span>

        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Minute&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span>
            <span class="p">},</span>

        <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="s1">&#39;Uncertainty Flags&#39;</span><span class="p">,</span> <span class="s1">&#39;flag&#39;</span><span class="p">),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;flag&#39;</span>
            <span class="p">},</span>

        <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">temperature</span><span class="o">.</span><span class="n">DryBulbTemperature</span><span class="p">(),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
            <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mf">99.9</span>
            <span class="p">},</span>

        <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">temperature</span><span class="o">.</span><span class="n">DewPointTemperature</span><span class="p">(),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
            <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mf">99.9</span>
            <span class="p">},</span>

        <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">RelativeHumidity</span><span class="p">(),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">110</span>
            <span class="p">},</span>

        <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">pressure</span><span class="o">.</span><span class="n">AtmosphericStationPressure</span><span class="p">(),</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span>
            <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999999</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">31000</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">120000</span>
            <span class="p">},</span>

        <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyintensity</span><span class="o">.</span><span class="n">ExtraterrestrialHorizontalRadiation</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Wh/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyintensity</span><span class="o">.</span><span class="n">ExtraterrestrialDirectNormalRadiation</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Wh/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">12</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyflux</span><span class="o">.</span><span class="n">HorizontalInfraredRadiationIntensity</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;W/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">13</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyintensity</span><span class="o">.</span><span class="n">GlobalHorizontalRadiation</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Wh/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">14</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyintensity</span><span class="o">.</span><span class="n">DirectNormalRadiation</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Wh/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">15</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">energyintensity</span><span class="o">.</span><span class="n">DiffuseHorizontalRadiation</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Wh/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">16</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">illuminance</span><span class="o">.</span><span class="n">GlobalHorizontalIlluminance</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;lux&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999999</span><span class="p">,</span>  <span class="c1"># will be missing if &gt;= 999900</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">17</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">illuminance</span><span class="o">.</span><span class="n">DirectNormalIlluminance</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;lux&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999999</span><span class="p">,</span>  <span class="c1"># will be missing if &gt;= 999900</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">18</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">illuminance</span><span class="o">.</span><span class="n">DiffuseHorizontalIlluminance</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;lux&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999999</span><span class="p">,</span>  <span class="c1"># will be missing if &gt;= 999900</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">19</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">luminance</span><span class="o">.</span><span class="n">ZenithLuminance</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;cd/m2&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span><span class="p">,</span>  <span class="c1"># will be missing if &gt;= 9999</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span>
             <span class="p">},</span>

        <span class="mi">20</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">angle</span><span class="o">.</span><span class="n">WindDirection</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;degrees&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">360</span>
             <span class="p">},</span>

        <span class="mi">21</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">speed</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m/s&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">40</span>
             <span class="p">},</span>

        <span class="mi">22</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">TotalSkyCover</span><span class="p">(),</span>  <span class="c1"># used if Horizontal IR is missing</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;tenths&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
             <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span>
             <span class="p">},</span>

        <span class="mi">23</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">OpaqueSkyCover</span><span class="p">(),</span>  <span class="c1"># used if Horizontal IR is missing</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;tenths&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">99</span>
             <span class="p">},</span>

        <span class="mi">24</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="o">.</span><span class="n">Visibility</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;km&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9999</span>
             <span class="p">},</span>

        <span class="mi">25</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="o">.</span><span class="n">CeilingHeight</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">99999</span>
             <span class="p">},</span>

        <span class="mi">26</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Present Weather Observation&#39;</span><span class="p">,</span>
                                         <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;observation&#39;</span><span class="p">),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;observation&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">9</span>
             <span class="p">},</span>

        <span class="mi">27</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Present Weather Codes&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;codes&#39;</span><span class="p">),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;codes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999999999</span>
             <span class="p">},</span>

        <span class="mi">28</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="o">.</span><span class="n">PrecipitableWater</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span>
             <span class="p">},</span>

        <span class="mi">29</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">AerosolOpticalDepth</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;fraction&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span>
             <span class="p">},</span>

        <span class="mi">30</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="o">.</span><span class="n">SnowDepth</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span>
             <span class="p">},</span>

        <span class="mi">31</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">generic</span><span class="o">.</span><span class="n">GenericType</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Days Since Last Snowfall&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">99</span>
             <span class="p">},</span>

        <span class="mi">32</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">Albedo</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;fraction&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span>
             <span class="p">},</span>

        <span class="mi">33</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="o">.</span><span class="n">LiquidPrecipitationDepth</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">999</span>
             <span class="p">},</span>

        <span class="mi">34</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">fraction</span><span class="o">.</span><span class="n">LiquidPrecipitationQuantity</span><span class="p">(),</span>
             <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
             <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;fraction&#39;</span><span class="p">,</span>
             <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="mi">99</span>
             <span class="p">}</span>
    <span class="p">}</span>

<div class="viewcode-block" id="EPWFields.field_by_number"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPWFields.field_by_number">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">field_by_number</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">field_number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an EPWField based on field number.</span>

<span class="sd">        *   0 Year</span>
<span class="sd">        *   1 Month</span>
<span class="sd">        *   2 Day</span>
<span class="sd">        *   3 Hour</span>
<span class="sd">        *   4 Minute</span>
<span class="sd">        *   5 -</span>
<span class="sd">        *   6 Dry Bulb Temperature</span>
<span class="sd">        *   7 Dew Point Temperature</span>
<span class="sd">        *   8 Relative Humidity</span>
<span class="sd">        *   9 Atmospheric Station Pressure</span>
<span class="sd">        *   10 Extraterrestrial Horizontal Radiation</span>
<span class="sd">        *   11 Extraterrestrial Direct Normal Radiation</span>
<span class="sd">        *   12 Horizontal Infrared Radiation Intensity</span>
<span class="sd">        *   13 Global Horizontal Radiation</span>
<span class="sd">        *   14 Direct Normal Radiation</span>
<span class="sd">        *   15 Diffuse Horizontal Radiation</span>
<span class="sd">        *   16 Global Horizontal Illuminance</span>
<span class="sd">        *   17 Direct Normal Illuminance</span>
<span class="sd">        *   18 Diffuse Horizontal Illuminance</span>
<span class="sd">        *   19 Zenith Luminance</span>
<span class="sd">        *   20 Wind Direction</span>
<span class="sd">        *   21 Wind Speed</span>
<span class="sd">        *   22 Total Sky Cover</span>
<span class="sd">        *   23 Opaque Sky Cover</span>
<span class="sd">        *   24 Visibility</span>
<span class="sd">        *   25 Ceiling Height</span>
<span class="sd">        *   26 Present Weather Observation</span>
<span class="sd">        *   27 Present Weather Codes</span>
<span class="sd">        *   28 Precipitable Water</span>
<span class="sd">        *   29 Aerosol Optical Depth</span>
<span class="sd">        *   30 Snow Depth</span>
<span class="sd">        *   31 Days Since Last Snowfall</span>
<span class="sd">        *   32 Albedo</span>
<span class="sd">        *   33 Liquid Precipitation Depth</span>
<span class="sd">        *   34 Liquid Precipitation Quantity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EPWField</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_fields</span><span class="p">[</span><span class="n">field_number</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;EPW fields representation.&quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span></div>


<div class="viewcode-block" id="EPWField"><a class="viewcode-back" href="../../ladybug.epw.html#ladybug.epw.EPWField">[docs]</a><span class="k">class</span> <span class="nc">EPWField</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An EPW field.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Name of the field.</span>
<span class="sd">        type: field value type (e.g. int, float, str)</span>
<span class="sd">        unit: Field unit.</span>
<span class="sd">        missing: Missing value for the data type in EPW files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">field_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value_type</span> <span class="o">=</span> <span class="n">field_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;unit&#39;</span> <span class="ow">in</span> <span class="n">field_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">field_dict</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s1">&#39;missing&#39;</span> <span class="ow">in</span> <span class="n">field_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missing</span> <span class="o">=</span> <span class="n">field_dict</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missing</span> <span class="o">=</span> <span class="kc">None</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Ladybug Tools.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>