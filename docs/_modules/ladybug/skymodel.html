<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ladybug.skymodel &#8212; ladybug  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          ladybug</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datatype.html">ladybug.datatype package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ladybug.datatype.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.angle.html">ladybug.datatype.angle module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.area.html">ladybug.datatype.area module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.base.html">ladybug.datatype.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.distance.html">ladybug.datatype.distance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energy.html">ladybug.datatype.energy module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energyflux.html">ladybug.datatype.energyflux module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.energyintensity.html">ladybug.datatype.energyintensity module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.fraction.html">ladybug.datatype.fraction module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.generic.html">ladybug.datatype.generic module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.illuminance.html">ladybug.datatype.illuminance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.luminance.html">ladybug.datatype.luminance module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.mass.html">ladybug.datatype.mass module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.massflowrate.html">ladybug.datatype.massflowrate module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.power.html">ladybug.datatype.power module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.pressure.html">ladybug.datatype.pressure module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.rvalue.html">ladybug.datatype.rvalue module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.specificenergy.html">ladybug.datatype.specificenergy module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.speed.html">ladybug.datatype.speed module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperature.html">ladybug.datatype.temperature module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperaturedelta.html">ladybug.datatype.temperaturedelta module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.temperaturetime.html">ladybug.datatype.temperaturetime module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.thermalcondition.html">ladybug.datatype.thermalcondition module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.uvalue.html">ladybug.datatype.uvalue module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.volume.html">ladybug.datatype.volume module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ladybug.datatype.volumeflowrate.html">ladybug.datatype.volumeflowrate module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ladybug.datatype.html#module-ladybug.datatype">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.analysisperiod.html">ladybug.analysisperiod module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.color.html">ladybug.color module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datacollection.html">ladybug.datacollection module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.datacollectionimmutable.html">ladybug.datacollectionimmutable module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.designday.html">ladybug.designday module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.dt.html">ladybug.dt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.epw.html">ladybug.epw module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.futil.html">ladybug.futil module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.graphic.html">ladybug.graphic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.header.html">ladybug.header module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.legend.html">ladybug.legend module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.location.html">ladybug.location module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.psychrometrics.html">ladybug.psychrometrics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.rootfind.html">ladybug.rootfind module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.skymodel.html">ladybug.skymodel module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.stat.html">ladybug.stat module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.sunpath.html">ladybug.sunpath module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ladybug.wea.html">ladybug.wea module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ladybug.html#module-ladybug">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-4">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../ladybug.html">ladybug package</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-8 content" role="main">
      
  <h1>Source code for ladybug.skymodel</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding=utf-8</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="sd">&quot;&quot;&quot;Functions for computing radiation for different idealized skies&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.psychrometrics</span> <span class="k">import</span> <span class="n">dew_point_from_db_rh</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="k">try</span><span class="p">:</span>  <span class="c1"># python 2</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">izip</span> <span class="k">as</span> <span class="nb">zip</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># python 3</span>
    <span class="n">xrange</span> <span class="o">=</span> <span class="nb">range</span>


<span class="sd">&quot;&quot;&quot;ORIGINAL AHSRAE CLEAR SKY SOLAR MODEL&quot;&quot;&quot;</span>


<div class="viewcode-block" id="ashrae_clear_sky"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.ashrae_clear_sky">[docs]</a><span class="k">def</span> <span class="nf">ashrae_clear_sky</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">sky_clearness</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate solar flux for an original ASHRAE Clear Sky</span>

<span class="sd">    Args:</span>
<span class="sd">        altitudes: A list of solar altitudes in degrees</span>
<span class="sd">        month: An integer (1-12) indicating the month the altitudes belong to</span>
<span class="sd">        sky_clearness: A factor that will be multiplied by the output of</span>
<span class="sd">            the model. This is to help account for locations where clear,</span>
<span class="sd">            dry skies predominate (e.g., at high elevations) or,</span>
<span class="sd">            conversely, where hazy and humid conditions are frequent. See</span>
<span class="sd">            Threlkeld and Jordan (1958) for recommended values. Typical</span>
<span class="sd">            values range from 0.95 to 1.05 and are usually never more</span>
<span class="sd">            than 1.2. Default is set to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with two elements</span>

<span class="sd">        -   dir_norm_rad: A list of direct normal radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>

<span class="sd">        -   dif_horiz_rad: A list of diffuse horizontall radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># apparent solar irradiation at air mass m = 0</span>
    <span class="n">MONTHLY_A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1202</span><span class="p">,</span> <span class="mi">1187</span><span class="p">,</span> <span class="mi">1164</span><span class="p">,</span> <span class="mi">1130</span><span class="p">,</span> <span class="mi">1106</span><span class="p">,</span> <span class="mi">1092</span><span class="p">,</span> <span class="mi">1093</span><span class="p">,</span> <span class="mi">1107</span><span class="p">,</span> <span class="mi">1136</span><span class="p">,</span>
                 <span class="mi">1166</span><span class="p">,</span> <span class="mi">1190</span><span class="p">,</span> <span class="mi">1204</span><span class="p">]</span>
    <span class="c1"># atmospheric extinction coefficient</span>
    <span class="n">MONTHLY_B</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.141</span><span class="p">,</span> <span class="mf">0.142</span><span class="p">,</span> <span class="mf">0.149</span><span class="p">,</span> <span class="mf">0.164</span><span class="p">,</span> <span class="mf">0.177</span><span class="p">,</span> <span class="mf">0.185</span><span class="p">,</span> <span class="mf">0.186</span><span class="p">,</span> <span class="mf">0.182</span><span class="p">,</span>
                 <span class="mf">0.165</span><span class="p">,</span> <span class="mf">0.152</span><span class="p">,</span> <span class="mf">0.144</span><span class="p">,</span> <span class="mf">0.141</span><span class="p">]</span>

    <span class="n">dir_norm_rad</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dif_horiz_rad</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">altitudes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">alt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dir_norm</span> <span class="o">=</span> <span class="n">MONTHLY_A</span><span class="p">[</span><span class="n">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                    <span class="n">MONTHLY_B</span><span class="p">[</span><span class="n">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alt</span><span class="p">)))))</span>
                <span class="n">diff_horiz</span> <span class="o">=</span> <span class="mf">0.17</span> <span class="o">*</span> <span class="n">dir_norm</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alt</span><span class="p">))</span>
                <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_norm</span> <span class="o">*</span> <span class="n">sky_clearness</span><span class="p">)</span>
                <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_horiz</span> <span class="o">*</span> <span class="n">sky_clearness</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
                <span class="c1"># very small altitude values</span>
                <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># night time</span>
            <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dir_norm_rad</span><span class="p">,</span> <span class="n">dif_horiz_rad</span></div>


<span class="sd">&quot;&quot;&quot;AHSRAE REVISED CLEAR SKY SOLAR MODEL (TAU MODEL)&quot;&quot;&quot;</span>


<div class="viewcode-block" id="ashrae_revised_clear_sky"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.ashrae_revised_clear_sky">[docs]</a><span class="k">def</span> <span class="nf">ashrae_revised_clear_sky</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">use_2017_model</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate solar flux for an ASHRAE Revised Clear Sky (&quot;Tau Model&quot;).</span>

<span class="sd">    By default, this function returns clear sky values following the</span>
<span class="sd">    methods originally published in the ASHRAE 2009 HOF.</span>

<span class="sd">    Args:</span>
<span class="sd">        altitudes: A list of solar altitudes in degrees.</span>
<span class="sd">        tb: A value indicating the beam optical depth of the sky.</span>
<span class="sd">        td: A value indicating the diffuse optical depth of the sky.</span>
<span class="sd">        use_2017_model: Set to True to use coefficients associated with</span>
<span class="sd">            the new version of the Tau model released in the 2013 and 2017 HOF.</span>
<span class="sd">            Note that the correct use of the new version requires updated</span>
<span class="sd">            tb and td values. At present, all .stat files</span>
<span class="sd">            distributed by the US DoE are using the older (2009) values</span>
<span class="sd">            for tb and td and so this input defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with two elements</span>

<span class="sd">        -   dir_norm_rad: A list of direct normal radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>

<span class="sd">        -   dif_horiz_rad: A list of diffuse horizontall radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dir_norm_rad</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dif_horiz_rad</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">use_2017_model</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ab</span> <span class="o">=</span> <span class="mf">1.454</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.406</span> <span class="o">*</span> <span class="n">tb</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.268</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.021</span> <span class="o">*</span> <span class="n">tb</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span>
        <span class="n">ad</span> <span class="o">=</span> <span class="mf">0.507</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.205</span> <span class="o">*</span> <span class="n">tb</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.080</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.190</span> <span class="o">*</span> <span class="n">tb</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ab</span> <span class="o">=</span> <span class="mf">1.219</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.043</span> <span class="o">*</span> <span class="n">tb</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.151</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.204</span> <span class="o">*</span> <span class="n">tb</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span>
        <span class="n">ad</span> <span class="o">=</span> <span class="mf">0.202</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.852</span> <span class="o">*</span> <span class="n">tb</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.007</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.357</span> <span class="o">*</span> <span class="n">tb</span> <span class="o">*</span> <span class="n">td</span><span class="p">)</span>

    <span class="c1"># compute hourly radiation</span>
    <span class="k">for</span> <span class="n">alt</span> <span class="ow">in</span> <span class="n">altitudes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">alt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># calculate hourly air mass between top of the atmosphere and earth</span>
            <span class="n">air_mass</span> <span class="o">=</span> <span class="n">get_relative_airmass</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
            <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1415</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tb</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">air_mass</span><span class="p">,</span> <span class="n">ab</span><span class="p">)))</span>
            <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1415</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">td</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">air_mass</span><span class="p">,</span> <span class="n">ad</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dir_norm_rad</span><span class="p">,</span> <span class="n">dif_horiz_rad</span></div>


<span class="sd">&quot;&quot;&quot;ZHANG-HUANG SOLAR MODEL&quot;&quot;&quot;</span>


<div class="viewcode-block" id="zhang_huang_solar"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.zhang_huang_solar">[docs]</a><span class="k">def</span> <span class="nf">zhang_huang_solar</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">cloud_cover</span><span class="p">,</span> <span class="n">relative_humidity</span><span class="p">,</span>
                      <span class="n">dry_bulb_present</span><span class="p">,</span> <span class="n">dry_bulb_t3_hrs</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span>
                      <span class="n">irr_0</span><span class="o">=</span><span class="mi">1355</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate global horizontal solar irradiance using the Zhang-Huang model.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Zhang, Q.Y. and Huang, Y.J. 2002. &quot;Development of typical year weather files</span>
<span class="sd">        for Chinese locations&quot;, LBNL-51436, ASHRAE Transactions, Vol. 108, Part 2.</span>

<span class="sd">    Args:</span>
<span class="sd">        alt: A solar altitude in degrees.</span>
<span class="sd">        cloud_cover: A float value between 0 and 10 that represents the sky cloud cover</span>
<span class="sd">            in tenths (0 = clear; 10 = completely overcast)</span>
<span class="sd">        relative_humidity: A float value between 0 and 100 that represents</span>
<span class="sd">            the relative humidity in percent.</span>
<span class="sd">        dry_bulb_present: A float value that represents the dry bulb</span>
<span class="sd">            temperature at the time of interest (in degrees C).</span>
<span class="sd">        dry_bulb_t3_hrs: A float value that represents the dry bulb</span>
<span class="sd">            temperature at three hours before the time of interest (in degrees C).</span>
<span class="sd">        wind_speed: A float value that represents the wind speed in m/s.</span>
<span class="sd">        irr_0 = Optional extraterrestrial solar constant (W/m2).</span>
<span class="sd">            Default is to use the average value over the earth&#39;s orbit (1355).</span>

<span class="sd">    Returns:</span>
<span class="sd">        glob_ir -- A global horizontall radiation value in W/m2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># zhang-huang solar model regression constants</span>
    <span class="n">C0</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">C5</span><span class="p">,</span> <span class="n">D_COEFF</span><span class="p">,</span> <span class="n">K_COEFF</span> <span class="o">=</span> <span class="mf">0.5598</span><span class="p">,</span> <span class="mf">0.4982</span><span class="p">,</span> \
        <span class="o">-</span><span class="mf">0.6762</span><span class="p">,</span> <span class="mf">0.02842</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00317</span><span class="p">,</span> <span class="mf">0.014</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.853</span><span class="p">,</span> <span class="mf">0.843</span>

    <span class="c1"># start assuming night time</span>
    <span class="n">glob_ir</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">alt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># get sin of the altitude</span>
        <span class="n">sin_alt</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alt</span><span class="p">))</span>

        <span class="c1"># shortened and converted versions of the input parameters</span>
        <span class="n">cc</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">n_temp</span><span class="p">,</span> <span class="n">n3_temp</span><span class="p">,</span> <span class="n">w_spd</span> <span class="o">=</span> <span class="n">cloud_cover</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">,</span> \
            <span class="n">relative_humidity</span><span class="p">,</span> <span class="n">dry_bulb_present</span><span class="p">,</span> <span class="n">dry_bulb_t3_hrs</span><span class="p">,</span> <span class="n">wind_speed</span>

        <span class="c1"># calculate zhang-huang global radiation</span>
        <span class="n">glob_ir</span> <span class="o">=</span> <span class="p">((</span><span class="n">irr_0</span> <span class="o">*</span> <span class="n">sin_alt</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">C0</span> <span class="o">+</span> <span class="p">(</span><span class="n">C1</span> <span class="o">*</span> <span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">C2</span> <span class="o">*</span> <span class="n">cc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_temp</span> <span class="o">-</span> <span class="n">n3_temp</span><span class="p">))</span> <span class="o">+</span>
                     <span class="p">(</span><span class="n">C4</span> <span class="o">*</span> <span class="n">rh</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">C5</span> <span class="o">*</span> <span class="n">w_spd</span><span class="p">)))</span> <span class="o">+</span> <span class="n">D_COEFF</span><span class="p">)</span> <span class="o">/</span> <span class="n">K_COEFF</span>
        <span class="k">if</span> <span class="n">glob_ir</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">glob_ir</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">glob_ir</span></div>


<div class="viewcode-block" id="zhang_huang_solar_split"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.zhang_huang_solar_split">[docs]</a><span class="k">def</span> <span class="nf">zhang_huang_solar_split</span><span class="p">(</span><span class="n">altitudes</span><span class="p">,</span> <span class="n">doys</span><span class="p">,</span> <span class="n">cloud_cover</span><span class="p">,</span> <span class="n">relative_humidity</span><span class="p">,</span>
                            <span class="n">dry_bulb_present</span><span class="p">,</span> <span class="n">dry_bulb_t3_hrs</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span>
                            <span class="n">atm_pressure</span><span class="p">,</span> <span class="n">use_disc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate direct and diffuse solar irradiance using the Zhang-Huang model.</span>

<span class="sd">    By default, this function uses the DIRINT method (aka. Perez split) to split global</span>
<span class="sd">    irradiance into direct and diffuse.  This is the same method used by EnergyPlus.</span>

<span class="sd">    Args:</span>
<span class="sd">        altitudes: A list of solar altitudes in degrees.</span>
<span class="sd">        doys: A list of days of the year that correspond to the altitudes.</span>
<span class="sd">        cloud_cover: A list of float values between 0 and 10 that represents cloud cover</span>
<span class="sd">            in tenths (0 = clear; 10 = completely overcast)</span>
<span class="sd">        relative_humidity: A list of float values between 0 and 100 that represents</span>
<span class="sd">            the relative humidity in percent.</span>
<span class="sd">        dry_bulb_present: A list of float values that represents the dry bulb</span>
<span class="sd">            temperature at the time of interest (in degrees C).</span>
<span class="sd">        dry_bulb_t3_hrs: A list of float values that represents the dry bulb</span>
<span class="sd">            temperature at three hours before the time of interest (in degrees C).</span>
<span class="sd">        wind_speed: A list of float values that represents the wind speed in m/s.</span>
<span class="sd">        atm_pressure: A list of float values that represent the</span>
<span class="sd">            atmospheric pressure in Pa.</span>
<span class="sd">        use_disc: Set to True to use the original DISC model as opposed to the</span>
<span class="sd">            newer and more accurate DIRINT model. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with two elements</span>

<span class="sd">        -   dir_norm_rad: A list of direct normal radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>

<span class="sd">        -   dif_horiz_rad: A list of diffuse horizontall radiation values for each</span>
<span class="sd">            of the connected altitudes in W/m2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate global horizontal irradiance using the original zhang-huang model</span>
    <span class="n">glob_ir</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">altitudes</span><span class="p">)):</span>
        <span class="n">ghi</span> <span class="o">=</span> <span class="n">zhang_huang_solar</span><span class="p">(</span><span class="n">altitudes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cloud_cover</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">relative_humidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                <span class="n">dry_bulb_present</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dry_bulb_t3_hrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">wind_speed</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">glob_ir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ghi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_disc</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="c1"># Calculate dew point temperature to improve the splitting of direct + diffuse</span>
        <span class="n">temp_dew</span> <span class="o">=</span> <span class="p">[</span><span class="n">dew_point_from_db_rh</span><span class="p">(</span><span class="n">dry_bulb_present</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">relative_humidity</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">glob_ir</span><span class="p">))]</span>

        <span class="c1"># Split global rad into direct + diffuse using dirint method (aka. Perez split)</span>
        <span class="n">dir_norm_rad</span> <span class="o">=</span> <span class="n">dirint</span><span class="p">(</span><span class="n">glob_ir</span><span class="p">,</span> <span class="n">altitudes</span><span class="p">,</span> <span class="n">doys</span><span class="p">,</span> <span class="n">atm_pressure</span><span class="p">,</span>
                              <span class="n">use_delta_kt_prime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temp_dew</span><span class="o">=</span><span class="n">temp_dew</span><span class="p">)</span>

        <span class="c1"># Calculate diffuse horizontal from dni and ghi.</span>
        <span class="n">dif_horiz_rad</span> <span class="o">=</span> <span class="p">[</span><span class="n">glob_ir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                         <span class="p">(</span><span class="n">dir_norm_rad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">altitudes</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">glob_ir</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dir_norm_rad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dif_horiz_rad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">glob_ir</span><span class="p">)):</span>
            <span class="n">dni</span><span class="p">,</span> <span class="n">kt</span><span class="p">,</span> <span class="n">am</span> <span class="o">=</span> <span class="n">disc</span><span class="p">(</span><span class="n">glob_ir</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">altitudes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">doys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">atm_pressure</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">dhi</span> <span class="o">=</span> <span class="n">glob_ir</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">dni</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">altitudes</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="n">dir_norm_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span>
            <span class="n">dif_horiz_rad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dhi</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dir_norm_rad</span><span class="p">,</span> <span class="n">dif_horiz_rad</span></div>


<span class="sd">&quot;&quot;&quot;LUMINOUS EFFICACY OF THE SKY&quot;&quot;&quot;</span>


<div class="viewcode-block" id="estimate_illuminance_from_irradiance"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.estimate_illuminance_from_irradiance">[docs]</a><span class="k">def</span> <span class="nf">estimate_illuminance_from_irradiance</span><span class="p">(</span>
        <span class="n">altitude</span><span class="p">,</span> <span class="n">ghi</span><span class="p">,</span> <span class="n">dni</span><span class="p">,</span> <span class="n">dhi</span><span class="p">,</span> <span class="n">dew_point</span><span class="p">,</span> <span class="n">rel_airmass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Estimate sky illuminance components from irradiance components.</span>

<span class="sd">    This function uses actual zenith rather than apparent zenith.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Perez R. (1990). &#39;Modeling Daylight Availability and Irradiance</span>
<span class="sd">        Components from Direct and Global Irradiance&#39;. Solar Energy.</span>
<span class="sd">        Vol. 44. No. 5, pp. 271-289. USA.</span>

<span class="sd">    Args:</span>
<span class="sd">        altitude: Solar altitude angle in degrees.</span>
<span class="sd">        ghi: Number for Global Horizontal Irradiance in W/m2.</span>
<span class="sd">        dni: Number for Direct Normal Irradiance in W/m2.</span>
<span class="sd">        dhi: Number for Diffuse Horizontal Irradiance in W/m2.</span>
<span class="sd">        dew_point: Surface dewpoint in degrees C.</span>
<span class="sd">        rel_airmass: A number between 1 and ~38 representing the ratio of air mass</span>
<span class="sd">            between the sun and the observer and the air mass that is directly above</span>
<span class="sd">            the observer. Default is None, which will simply use the input solar</span>
<span class="sd">            altitude and the get_relative_airmass function in this module with</span>
<span class="sd">            the kastenyoung1989 model to compute this value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with four elements</span>

<span class="sd">        -   gh_ill: Value for Global Horizontal Illuminance in lux.</span>

<span class="sd">        -   dn_ill: Value for Direct Normal Illuminance in lux.</span>

<span class="sd">        -   dh_ill: Value for Diffuse Horizontal Illuminance in lux.</span>

<span class="sd">        -   z_lum: Value for Zenith Luminance in lux.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">altitude</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># sun is below the horizon, return 0 for all results</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">rel_airmass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rel_airmass</span> <span class="o">=</span> <span class="n">get_relative_airmass</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>
    <span class="n">zenith</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">altitude</span><span class="p">)</span>
    <span class="n">dhi</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="k">if</span> <span class="n">dhi</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">dhi</span>
    <span class="n">kai</span> <span class="o">=</span> <span class="mf">1.041</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="p">((</span><span class="n">dhi</span> <span class="o">+</span> <span class="n">dni</span><span class="p">)</span> <span class="o">/</span> <span class="n">dhi</span> <span class="o">+</span> <span class="n">kai</span> <span class="o">*</span> <span class="n">zenith</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kai</span> <span class="o">*</span> <span class="n">zenith</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">dhi</span> <span class="o">*</span> <span class="n">rel_airmass</span> <span class="o">/</span> <span class="mi">1360</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.08</span> <span class="o">*</span> <span class="n">dew_point</span> <span class="o">-</span> <span class="mf">0.075</span><span class="p">)</span>

    <span class="c1"># Perez Table 1: Discrete Sky Clearness Categories</span>
    <span class="k">if</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1.065</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">1.065</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1.23</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">1.23</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">1.5</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">1.95</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">1.95</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">2.8</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">2.8</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">4.5</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">4.5</span> <span class="ow">and</span> <span class="n">eps</span> <span class="o">&lt;</span> <span class="mf">6.2</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">elif</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">6.2</span><span class="p">:</span>
        <span class="n">e_category</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Error in sky luminous efficacy calculation</span><span class="se">\n</span><span class="s1">&#39;</span>
                         <span class="s1">&#39;eps: </span><span class="si">%f</span><span class="s1">  altitude: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="n">altitude</span><span class="p">))</span>

    <span class="c1"># Perez Table 4: Luminous Efficacy</span>
    <span class="n">glob_lum_eff_coeff</span> <span class="o">=</span> <span class="p">((</span><span class="mf">96.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">11.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.16</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">107.54</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.79</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.19</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">98.73</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span> <span class="mf">4.40</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.95</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">92.72</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">8.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.31</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">86.73</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">7.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.94</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">88.34</span><span class="p">,</span> <span class="mf">1.39</span><span class="p">,</span> <span class="mf">6.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.60</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">78.63</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">,</span> <span class="mf">4.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.37</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">99.65</span><span class="p">,</span> <span class="mf">1.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.15</span><span class="p">))</span>

    <span class="n">dir_lum_eff_coeff</span> <span class="o">=</span> <span class="p">((</span><span class="mf">57.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.98</span><span class="p">,</span> <span class="mf">117.12</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">98.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.21</span><span class="p">,</span> <span class="mf">12.38</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">109.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.81</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">110.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.56</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">106.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.16</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">107.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.51</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.73</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">105.75</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.44</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">101.18</span><span class="p">,</span> <span class="mf">1.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.29</span><span class="p">))</span>

    <span class="n">diff_lum_eff_coeff</span> <span class="o">=</span> <span class="p">((</span><span class="mf">97.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.46</span><span class="p">,</span> <span class="mf">12.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.91</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">107.22</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.95</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">104.97</span><span class="p">,</span> <span class="mf">2.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.77</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">102.39</span><span class="p">,</span> <span class="mf">5.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.90</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">100.71</span><span class="p">,</span> <span class="mf">5.94</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.74</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">106.42</span><span class="p">,</span> <span class="mf">3.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">36.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.83</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">141.88</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">,</span> <span class="o">-</span><span class="mf">53.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.03</span><span class="p">),</span>
                          <span class="p">(</span><span class="mf">152.23</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.98</span><span class="p">))</span>

    <span class="n">zen_lum_eff_coeff</span> <span class="o">=</span> <span class="p">((</span><span class="mf">40.86</span><span class="p">,</span> <span class="mf">26.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.75</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">26.58</span><span class="p">,</span> <span class="mf">14.73</span><span class="p">,</span> <span class="mf">58.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.25</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">19.34</span><span class="p">,</span> <span class="mf">2.28</span><span class="p">,</span> <span class="mf">100.00</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">13.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.39</span><span class="p">,</span> <span class="mf">124.79</span><span class="p">,</span> <span class="mf">15.66</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">14.47</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.09</span><span class="p">,</span> <span class="mf">160.09</span><span class="p">,</span> <span class="mf">9.13</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">19.76</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.88</span><span class="p">,</span> <span class="mf">154.61</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.21</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">28.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.67</span><span class="p">,</span> <span class="mf">151.58</span><span class="p">,</span> <span class="o">-</span><span class="mf">69.39</span><span class="p">),</span>
                         <span class="p">(</span><span class="mf">42.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.62</span><span class="p">,</span> <span class="mf">130.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">164.08</span><span class="p">))</span>

    <span class="c1"># Eq 6</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">glob_lum_eff_coeff</span><span class="p">[</span><span class="n">e_category</span><span class="p">]</span>
    <span class="n">gh_ill</span> <span class="o">=</span> <span class="n">ghi</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">w</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zenith</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>

    <span class="c1"># Eq 8</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dir_lum_eff_coeff</span><span class="p">[</span><span class="n">e_category</span><span class="p">]</span>
    <span class="n">dn_ill</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dni</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">w</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">5.73</span> <span class="o">*</span> <span class="n">zenith</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">delta</span><span class="p">))</span>

    <span class="c1"># Eq 7</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">diff_lum_eff_coeff</span><span class="p">[</span><span class="n">e_category</span><span class="p">]</span>
    <span class="n">dh_ill</span> <span class="o">=</span> <span class="n">dhi</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">w</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zenith</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>

    <span class="c1"># Eq 9</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">zen_lum_eff_coeff</span><span class="p">[</span><span class="n">e_category</span><span class="p">]</span>
    <span class="n">z_lum</span> <span class="o">=</span> <span class="n">dhi</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zenith</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">zenith</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gh_ill</span><span class="p">,</span> <span class="n">dn_ill</span><span class="p">,</span> <span class="n">dh_ill</span><span class="p">,</span> <span class="n">z_lum</span></div>


<span class="sd">&quot;&quot;&quot;HORIZONTAL INFRARED INTENSITY + SKY TEMPERATURE MODELS&quot;&quot;&quot;</span>


<div class="viewcode-block" id="calc_horizontal_infrared"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.calc_horizontal_infrared">[docs]</a><span class="k">def</span> <span class="nf">calc_horizontal_infrared</span><span class="p">(</span><span class="n">sky_cover</span><span class="p">,</span> <span class="n">dry_bulb</span><span class="p">,</span> <span class="n">dew_point</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate horizontal infrared radiation intensity.</span>

<span class="sd">    See EnergyPlus Enrineering Reference for more information:</span>
<span class="sd">    https://bigladdersoftware.com/epx/docs/8-9/engineering-reference/climate-calculations.html#sky-radiation-modeling</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Walton, G. N. 1983. Thermal Analysis Research Program Reference Manual.</span>
<span class="sd">        NBSSIR 83-2655. National Bureau of Standards, p. 21.</span>

<span class="sd">        [2] Clark, G. and C. Allen, “The Estimation of Atmospheric Radiation for</span>
<span class="sd">        Clear and Cloudy Skies,” Proceedings 2nd National Passive Solar Conference</span>
<span class="sd">        (AS/ISES), 1978, pp. 675-678.</span>

<span class="sd">    Args:</span>
<span class="sd">        sky_cover: A float value between 0 and 10 that represents the opaque</span>
<span class="sd">            sky cover in tenths (0 = clear; 10 = completely overcast)</span>
<span class="sd">        dry_bulb: A float value that represents the dry bulb temperature</span>
<span class="sd">            in degrees C.</span>
<span class="sd">        dew_point: A float value that represents the dew point temperature</span>
<span class="sd">            in degrees C.</span>

<span class="sd">    Returns:</span>
<span class="sd">        horiz_ir -- A horizontal infrared radiation intensity value in W/m2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># stefan-boltzmann constant</span>
    <span class="n">SIGMA</span> <span class="o">=</span> <span class="mf">5.6697e-8</span>

    <span class="c1"># convert to kelvin</span>
    <span class="n">db_k</span> <span class="o">=</span> <span class="n">dry_bulb</span> <span class="o">+</span> <span class="mf">273.15</span>
    <span class="n">dp_k</span> <span class="o">=</span> <span class="n">dew_point</span> <span class="o">+</span> <span class="mf">273.15</span>

    <span class="c1"># calculate sky emissivity and horizontal ir</span>
    <span class="n">sky_emiss</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.787</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.764</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dp_k</span> <span class="o">/</span> <span class="mf">273.15</span><span class="p">)))</span> <span class="o">*</span> \
        <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.022</span> <span class="o">*</span> <span class="n">sky_cover</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.0035</span> <span class="o">*</span> <span class="p">(</span><span class="n">sky_cover</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="mf">0.00028</span> <span class="o">*</span> <span class="p">(</span><span class="n">sky_cover</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="n">horiz_ir</span> <span class="o">=</span> <span class="n">sky_emiss</span> <span class="o">*</span> <span class="n">SIGMA</span> <span class="o">*</span> <span class="p">(</span><span class="n">db_k</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">horiz_ir</span></div>


<div class="viewcode-block" id="calc_sky_temperature"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.calc_sky_temperature">[docs]</a><span class="k">def</span> <span class="nf">calc_sky_temperature</span><span class="p">(</span><span class="n">horiz_ir</span><span class="p">,</span> <span class="n">source_emissivity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate sky temperature in Celcius.</span>

<span class="sd">    See EnergyPlus Enrineering Reference for more information:</span>
<span class="sd">    https://bigladdersoftware.com/epx/docs/8-9/engineering-reference/</span>
<span class="sd">    climate-calculations.html#energyplus-sky-temperature-calculation</span>

<span class="sd">    Args:</span>
<span class="sd">        horiz_ir: A float value that represents horizontal infrared radiation</span>
<span class="sd">            intensity in W/m2.</span>
<span class="sd">        source_emissivity: A float value between 0 and 1 indicating the emissivity</span>
<span class="sd">             of the heat source that is radiating to the sky. Default is 1 for</span>
<span class="sd">             most outdoor surfaces.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sky_temp -- A sky temperature value in C.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.6697e-8</span>  <span class="c1"># stefan-boltzmann constant</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">horiz_ir</span> <span class="o">/</span> <span class="p">(</span><span class="n">source_emissivity</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="mf">273.15</span></div>


<span class="sd">&quot;&quot;&quot;DIRECT AND DIFFUSE SPLITTING FROM GLOBAL HORIZONTAL&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot;The following code is a modified version of the PVLib python library.</span>

<span class="sd">PVLib</span>
<span class="sd">Copyright (c) 2013-2018, Sandia National Laboratories and pvlib python Development Team</span>
<span class="sd">All rights reserved.</span>

<span class="sd">Developed at Sandia National Laboratories, PVLib implements</span>
<span class="sd">many of the models and methods developed at the Lab.</span>
<span class="sd">More information can be found on the pvlib-python github:</span>
<span class="sd">https://github.com/pvlib/pvlib-python</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="dirint"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.dirint">[docs]</a><span class="k">def</span> <span class="nf">dirint</span><span class="p">(</span><span class="n">ghi</span><span class="p">,</span> <span class="n">altitudes</span><span class="p">,</span> <span class="n">doys</span><span class="p">,</span> <span class="n">pressures</span><span class="p">,</span> <span class="n">use_delta_kt_prime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">temp_dew</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_sin_altitude</span><span class="o">=</span><span class="mf">0.065</span><span class="p">,</span> <span class="n">min_altitude</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine DNI from GHI using the DIRINT modification of the DISC</span>
<span class="sd">    model.</span>

<span class="sd">    Implements the modified DISC model known as &quot;DIRINT&quot; introduced in</span>
<span class="sd">    [1]. DIRINT predicts direct normal irradiance (DNI) from measured</span>
<span class="sd">    global horizontal irradiance (GHI). DIRINT improves upon the DISC</span>
<span class="sd">    model by using time-series GHI data and dew point temperature</span>
<span class="sd">    information. The effectiveness of the DIRINT model improves with</span>
<span class="sd">    each piece of information provided.</span>

<span class="sd">    The pvlib implementation limits the clearness index to 1.</span>
<span class="sd">    The DIRINT model requires time series data.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Perez, R., P. Ineichen, E. Maxwell, R. Seals and A. Zelenka,</span>
<span class="sd">        (1992). &quot;Dynamic Global-to-Direct Irradiance Conversion Models&quot;.</span>
<span class="sd">        ASHRAE Transactions-Research Series, pp. 354-369</span>

<span class="sd">        [2] Maxwell, E. L., &quot;A Quasi-Physical Model for Converting Hourly</span>
<span class="sd">        Global Horizontal to Direct Normal Insolation&quot;, Technical Report No.</span>
<span class="sd">        SERI/TR-215-3087, Golden, CO: Solar Energy Research Institute, 1987.</span>

<span class="sd">    Args:</span>
<span class="sd">        ghi: array-like</span>
<span class="sd">            Global horizontal irradiance in W/m^2.</span>
<span class="sd">        altitudes: array-like</span>
<span class="sd">            True (not refraction-corrected) solar altitude angles in decimal</span>
<span class="sd">            degrees.</span>
<span class="sd">        doys: array-like</span>
<span class="sd">            Integers representing the day of the year.</span>
<span class="sd">        pressures: array-like</span>
<span class="sd">            The site pressure in Pascal. Pressure may be measured or an</span>
<span class="sd">            average pressure may be calculated from site altitude.</span>
<span class="sd">        use_delta_kt_prime: bool, default True</span>
<span class="sd">            If True, indicates that the stability index delta_kt_prime is</span>
<span class="sd">            included in the model. The stability index adjusts the estimated</span>
<span class="sd">            DNI in response to dynamics in the time series of GHI. It is</span>
<span class="sd">            recommended that delta_kt_prime is not used if the time between</span>
<span class="sd">            GHI points is 1.5 hours or greater. If use_delta_kt_prime=True,</span>
<span class="sd">            input data must be Series.</span>
<span class="sd">        temp_dew: None or array-like, default None</span>
<span class="sd">            Surface dew point temperatures, in degrees C. Values of temp_dew</span>
<span class="sd">            must be numeric. If temp_dew is not provided, then dew point</span>
<span class="sd">            improvements are not applied.</span>
<span class="sd">        min_sin_altitude: numeric, default 0.065</span>
<span class="sd">            Minimum value of sin(altitude) to allow when calculating global</span>
<span class="sd">            clearness index `kt`. Equivalent to altitude = 3.727 degrees.</span>
<span class="sd">        min_altitude: numeric, default 87</span>
<span class="sd">            Minimum value of altitude to allow in DNI calculation. DNI will be</span>
<span class="sd">            set to 0 for times with altitude values smaller than `min_altitude`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dni -- array-like.</span>
<span class="sd">        The modeled direct normal irradiance in W/m^2 provided by the</span>
<span class="sd">        DIRINT model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate kt_prime values</span>
    <span class="n">kt_primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">disc_dni</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ghi</span><span class="p">)):</span>
        <span class="n">dni</span><span class="p">,</span> <span class="n">kt</span><span class="p">,</span> <span class="n">airmass</span> <span class="o">=</span> <span class="n">disc</span><span class="p">(</span><span class="n">ghi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">altitudes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">doys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pressure</span><span class="o">=</span><span class="n">pressures</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                <span class="n">min_sin_altitude</span><span class="o">=</span><span class="n">min_sin_altitude</span><span class="p">,</span>
                                <span class="n">min_altitude</span><span class="o">=</span><span class="n">min_altitude</span><span class="p">)</span>
        <span class="n">kt_prime</span> <span class="o">=</span> <span class="n">clearness_index_zenith_independent</span><span class="p">(</span>
            <span class="n">kt</span><span class="p">,</span> <span class="n">airmass</span><span class="p">,</span> <span class="n">max_clearness_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">kt_primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kt_prime</span><span class="p">)</span>
        <span class="n">disc_dni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dni</span><span class="p">)</span>

    <span class="c1"># calculate delta_kt_prime values</span>
    <span class="k">if</span> <span class="n">use_delta_kt_prime</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">delta_kt_prime</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kt_primes</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">kt_prime_1</span> <span class="o">=</span> <span class="n">kt_primes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c1"># last hour</span>
                <span class="n">kt_prime_1</span> <span class="o">=</span> <span class="n">kt_primes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">delta_kt_prime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">kt_primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">kt_prime_1</span><span class="p">)</span> <span class="o">+</span>
                                         <span class="nb">abs</span><span class="p">(</span><span class="n">kt_primes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">kt_primes</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_kt_prime</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ghi</span><span class="p">)</span>

    <span class="c1"># calculate W values if dew point temperatures have been provided</span>
    <span class="k">if</span> <span class="n">temp_dew</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.07</span> <span class="o">*</span> <span class="n">td</span> <span class="o">-</span> <span class="mf">0.075</span><span class="p">)</span> <span class="k">for</span> <span class="n">td</span> <span class="ow">in</span> <span class="n">temp_dew</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ghi</span><span class="p">)</span>

    <span class="c1"># bin the values into appropriate categoreis for lookup in the coefficient matirx.</span>
    <span class="n">ktp_bin</span><span class="p">,</span> <span class="n">alt_bin</span><span class="p">,</span> <span class="n">w_bin</span><span class="p">,</span> <span class="n">delta_ktp_bin</span> <span class="o">=</span> \
        <span class="n">_dirint_bins</span><span class="p">(</span><span class="n">kt_primes</span><span class="p">,</span> <span class="n">altitudes</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">delta_kt_prime</span><span class="p">)</span>

    <span class="c1"># get the dirint coefficient by looking up values in the matrix</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">_get_dirint_coeffs</span><span class="p">()</span>
    <span class="n">dirint_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">[</span><span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">delta_ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ghi</span><span class="p">))]</span>

    <span class="c1"># Perez eqn 5</span>
    <span class="n">dni</span> <span class="o">=</span> <span class="p">[</span><span class="n">disc_d</span> <span class="o">*</span> <span class="n">coef</span> <span class="k">for</span> <span class="n">disc_d</span><span class="p">,</span> <span class="n">coef</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">disc_dni</span><span class="p">,</span> <span class="n">dirint_coeffs</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">dni</span></div>


<span class="k">def</span> <span class="nf">_dirint_bins</span><span class="p">(</span><span class="n">ktp</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">dktp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the bins for the DIRINT coefficients.</span>

<span class="sd">    Args:</span>
<span class="sd">        ktp : Altitude-independent clearness index</span>
<span class="sd">        alt : Solar altitude angle</span>
<span class="sd">        w : precipitable water estimated from surface dew-point temperature</span>
<span class="sd">        dktp : stability index</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple of ktp_bin, alt_bin, w_bin, dktp_bin</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ktp</span><span class="p">))</span>

    <span class="c1"># Create kt_prime bins</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ktp</span><span class="p">)</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.24</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.24</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.4</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.4</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.56</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.56</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.7</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.7</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.8</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">ktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="k">if</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.8</span> <span class="ow">and</span> <span class="n">ktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">ktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>

    <span class="c1"># Create altitude angle bins</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">90</span> <span class="ow">and</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">65</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">65</span> <span class="ow">and</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">35</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">35</span> <span class="ow">and</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">alt_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="k">if</span> <span class="n">alt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="k">else</span> <span class="n">alt_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>

    <span class="c1"># Create the bins for w based on dew point temperature</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">w_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">w_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>

    <span class="c1"># Create delta_kt_prime binning.</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dktp</span><span class="p">)</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.015</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.015</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.035</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.035</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.07</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.07</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.15</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.15</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.3</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.3</span> <span class="ow">and</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>
    <span class="n">dktp_bin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span> <span class="k">if</span> <span class="n">dktp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="n">dktp_bin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">ktp_bin</span><span class="p">,</span> <span class="n">alt_bin</span><span class="p">,</span> <span class="n">w_bin</span><span class="p">,</span> <span class="n">dktp_bin</span>


<div class="viewcode-block" id="disc"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.disc">[docs]</a><span class="k">def</span> <span class="nf">disc</span><span class="p">(</span><span class="n">ghi</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">doy</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mi">101325</span><span class="p">,</span>
         <span class="n">min_sin_altitude</span><span class="o">=</span><span class="mf">0.065</span><span class="p">,</span> <span class="n">min_altitude</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_airmass</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate Direct Normal Irradiance from Global Horizontal Irradiance</span>
<span class="sd">    using the DISC model.</span>

<span class="sd">    The DISC algorithm converts global horizontal irradiance to direct</span>
<span class="sd">    normal irradiance through empirical relationships between the global</span>
<span class="sd">    and direct clearness indices.</span>

<span class="sd">    This implementation limits the clearness index to 1 by default.</span>

<span class="sd">    The original report describing the DISC model [1] uses the</span>
<span class="sd">    relative air mass rather than the absolute (pressure-corrected)</span>
<span class="sd">    air mass. However, the NREL implementation of the DISC model [2]</span>
<span class="sd">    uses absolute air mass. PVLib Matlab also uses the absolute air mass.</span>
<span class="sd">    pvlib python defaults to absolute air mass, but the relative airmass</span>
<span class="sd">    can be used by supplying `pressure=None`.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Maxwell, E. L., &quot;A Quasi-Physical Model for Converting Hourly</span>
<span class="sd">        Global Horizontal to Direct Normal Insolation&quot;, Technical</span>
<span class="sd">        Report No. SERI/TR-215-3087, Golden, CO: Solar Energy Research</span>
<span class="sd">        Institute, 1987.</span>

<span class="sd">        [2] Maxwell, E. &quot;DISC Model&quot;, Excel Worksheet.</span>
<span class="sd">        https://www.nrel.gov/grid/solar-resource/disc.html</span>

<span class="sd">    Args:</span>
<span class="sd">        ghi : numeric</span>
<span class="sd">            Global horizontal irradiance in W/m^2.</span>
<span class="sd">        altitude : numeric</span>
<span class="sd">            True (not refraction-corrected) solar altitude angles in decimal</span>
<span class="sd">            degrees.</span>
<span class="sd">        doy : An integer representing the day of the year.</span>
<span class="sd">        pressure : None or numeric, default 101325</span>
<span class="sd">            Site pressure in Pascal. If None, relative air mass is used</span>
<span class="sd">            instead of absolute (pressure-corrected) air mass.</span>
<span class="sd">        min_sin_altitude : numeric, default 0.065</span>
<span class="sd">            Minimum value of sin(altitude) to allow when calculating global</span>
<span class="sd">            clearness index `kt`. Equivalent to altitude = 3.727 degrees.</span>
<span class="sd">        min_altitude : numeric, default 87</span>
<span class="sd">            Minimum value of altitude to allow in DNI calculation. DNI will be</span>
<span class="sd">            set to 0 for times with altitude values smaller than `min_altitude`.</span>
<span class="sd">        max_airmass : numeric, default 12</span>
<span class="sd">            Maximum value of the air mass to allow in Kn calculation.</span>
<span class="sd">            Default value (12) comes from range over which Kn was fit</span>
<span class="sd">            to air mass in the original paper.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with two elements</span>

<span class="sd">        -   dni: The modeled direct normal irradiance</span>
<span class="sd">            in W/m^2 provided by the</span>
<span class="sd">            Direct Insolation Simulation Code (DISC) model.</span>

<span class="sd">        -   kt: Ratio of global to extraterrestrial</span>
<span class="sd">            irradiance on a horizontal plane.</span>

<span class="sd">        -   am: Airmass</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">altitude</span> <span class="o">&gt;</span> <span class="n">min_altitude</span> <span class="ow">and</span> <span class="n">ghi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># this is the I0 calculation from the reference</span>
        <span class="c1"># SSC uses solar constant = 1367.0 (checked 2018 08 15)</span>
        <span class="n">I0</span> <span class="o">=</span> <span class="n">get_extra_radiation</span><span class="p">(</span><span class="n">doy</span><span class="p">,</span> <span class="mf">1370.</span><span class="p">)</span>

        <span class="n">kt</span> <span class="o">=</span> <span class="n">clearness_index</span><span class="p">(</span><span class="n">ghi</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">min_sin_altitude</span><span class="o">=</span><span class="n">min_sin_altitude</span><span class="p">,</span>
                             <span class="n">max_clearness_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">am</span> <span class="o">=</span> <span class="n">get_relative_airmass</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;kasten1966&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pressure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">get_absolute_airmass</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>

        <span class="n">Kn</span><span class="p">,</span> <span class="n">am</span> <span class="o">=</span> <span class="n">_disc_kn</span><span class="p">(</span><span class="n">kt</span><span class="p">,</span> <span class="n">am</span><span class="p">,</span> <span class="n">max_airmass</span><span class="o">=</span><span class="n">max_airmass</span><span class="p">)</span>
        <span class="n">dni</span> <span class="o">=</span> <span class="n">Kn</span> <span class="o">*</span> <span class="n">I0</span>
        <span class="n">dni</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dni</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dni</span><span class="p">,</span> <span class="n">kt</span><span class="p">,</span> <span class="n">am</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span></div>


<span class="k">def</span> <span class="nf">_disc_kn</span><span class="p">(</span><span class="n">clearness_index</span><span class="p">,</span> <span class="n">airmass</span><span class="p">,</span> <span class="n">max_airmass</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate Kn for `disc`</span>

<span class="sd">    Args:</span>
<span class="sd">        clearness_index : numeric</span>
<span class="sd">        airmass : numeric</span>
<span class="sd">        max_airmass : float</span>
<span class="sd">            airmass &gt; max_airmass is set to max_airmass before being used</span>
<span class="sd">            in calculating Kn.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple with two elements</span>

<span class="sd">        -   Kn : numeric</span>

<span class="sd">        -   am : numeric</span>
<span class="sd">            airmass used in the calculation of Kn. am &lt;= max_airmass.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># short names for equations</span>
    <span class="n">kt</span> <span class="o">=</span> <span class="n">clearness_index</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">airmass</span>

    <span class="n">am</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">max_airmass</span><span class="p">)</span>  <span class="c1"># GH 450</span>

    <span class="c1"># powers of kt will be used repeatedly, so compute only once</span>
    <span class="n">kt2</span> <span class="o">=</span> <span class="n">kt</span> <span class="o">*</span> <span class="n">kt</span>  <span class="c1"># about the same as kt ** 2</span>
    <span class="n">kt3</span> <span class="o">=</span> <span class="n">kt2</span> <span class="o">*</span> <span class="n">kt</span>  <span class="c1"># 5-10x faster than kt ** 3</span>

    <span class="k">if</span> <span class="n">kt</span> <span class="o">&lt;=</span> <span class="mf">0.6</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mf">0.512</span> <span class="o">-</span> <span class="mf">1.56</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="mf">2.286</span><span class="o">*</span><span class="n">kt2</span> <span class="o">-</span> <span class="mf">2.222</span><span class="o">*</span><span class="n">kt3</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mf">0.37</span> <span class="o">+</span> <span class="mf">0.962</span><span class="o">*</span><span class="n">kt</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.28</span> <span class="o">+</span> <span class="mf">0.932</span><span class="o">*</span><span class="n">kt</span> <span class="o">-</span> <span class="mf">2.048</span><span class="o">*</span><span class="n">kt2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.743</span> <span class="o">+</span> <span class="mf">21.77</span><span class="o">*</span><span class="n">kt</span> <span class="o">-</span> <span class="mf">27.49</span><span class="o">*</span><span class="n">kt2</span> <span class="o">+</span> <span class="mf">11.56</span><span class="o">*</span><span class="n">kt3</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mf">41.4</span> <span class="o">-</span> <span class="mf">118.5</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="mf">66.05</span><span class="o">*</span><span class="n">kt2</span> <span class="o">+</span> <span class="mf">31.9</span><span class="o">*</span><span class="n">kt3</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">47.01</span> <span class="o">+</span> <span class="mf">184.2</span><span class="o">*</span><span class="n">kt</span> <span class="o">-</span> <span class="mf">222.0</span><span class="o">*</span><span class="n">kt2</span> <span class="o">+</span> <span class="mf">73.81</span><span class="o">*</span><span class="n">kt3</span>

    <span class="n">delta_kn</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">am</span><span class="p">)</span>

    <span class="n">Knc</span> <span class="o">=</span> <span class="mf">0.866</span> <span class="o">-</span> <span class="mf">0.122</span><span class="o">*</span><span class="n">am</span> <span class="o">+</span> <span class="mf">0.0121</span><span class="o">*</span><span class="n">am</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.000653</span><span class="o">*</span><span class="n">am</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">1.4e-05</span><span class="o">*</span><span class="n">am</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">Kn</span> <span class="o">=</span> <span class="n">Knc</span> <span class="o">-</span> <span class="n">delta_kn</span>
    <span class="k">return</span> <span class="n">Kn</span><span class="p">,</span> <span class="n">am</span>


<div class="viewcode-block" id="get_extra_radiation"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.get_extra_radiation">[docs]</a><span class="k">def</span> <span class="nf">get_extra_radiation</span><span class="p">(</span><span class="n">doy</span><span class="p">,</span> <span class="n">solar_constant</span><span class="o">=</span><span class="mf">1366.1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine extraterrestrial radiation from day of year (using the spencer method).</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] M. Reno, C. Hansen, and J. Stein, &quot;Global Horizontal Irradiance</span>
<span class="sd">        Clear Sky Models: Implementation and Analysis&quot;, Sandia National</span>
<span class="sd">        Laboratories, SAND2012-2389, 2012.</span>

<span class="sd">        [2] &lt;http://solardat.uoregon.edu/SolarRadiationBasics.html&gt;, Eqs.</span>
<span class="sd">        SR1 and SR2</span>

<span class="sd">    Args:</span>
<span class="sd">        doy : array of integers representing the days of the year.</span>
<span class="sd">        solar_constant : float, default 1366.1</span>
<span class="sd">            The solar constant.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dni_extra -- float, array, or Series.</span>
<span class="sd">        The extraterrestrial radiation present in watts per square meter</span>
<span class="sd">        on a surface which is normal to the sun. Pandas Timestamp and</span>
<span class="sd">        DatetimeIndex inputs will yield a Pandas TimeSeries. All other</span>
<span class="sd">        inputs will yield a float or an array of floats.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculates the day angle for the Earth&#39;s orbit around the Sun.</span>
    <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">365.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Calculate R over R squared from the angle</span>
    <span class="n">RoverR0sqrd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.00011</span> <span class="o">+</span> <span class="mf">0.034221</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00128</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span>
                   <span class="mf">0.000719</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mf">7.7e-05</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">B</span><span class="p">))</span>

    <span class="n">Ea</span> <span class="o">=</span> <span class="n">solar_constant</span> <span class="o">*</span> <span class="n">RoverR0sqrd</span>

    <span class="k">return</span> <span class="n">Ea</span></div>


<div class="viewcode-block" id="clearness_index"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.clearness_index">[docs]</a><span class="k">def</span> <span class="nf">clearness_index</span><span class="p">(</span><span class="n">ghi</span><span class="p">,</span> <span class="n">altitude</span><span class="p">,</span> <span class="n">extra_radiation</span><span class="p">,</span> <span class="n">min_sin_altitude</span><span class="o">=</span><span class="mf">0.065</span><span class="p">,</span>
                    <span class="n">max_clearness_index</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the clearness index.</span>

<span class="sd">    The clearness index is the ratio of global to extraterrestrial</span>
<span class="sd">    irradiance on a horizontal plane.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Maxwell, E. L., &quot;A Quasi-Physical Model for Converting Hourly</span>
<span class="sd">        Global Horizontal to Direct Normal Insolation&quot;, Technical</span>
<span class="sd">        Report No. SERI/TR-215-3087, Golden, CO: Solar Energy Research</span>
<span class="sd">        Institute, 1987.</span>

<span class="sd">    Args:</span>
<span class="sd">        ghi: numeric</span>
<span class="sd">            Global horizontal irradiance in W/m^2.</span>
<span class="sd">        altitude: numeric</span>
<span class="sd">            True (not refraction-corrected) solar altitude angle in decimal</span>
<span class="sd">            degrees.</span>
<span class="sd">        extra_radiation: numeric</span>
<span class="sd">            Irradiance incident at the top of the atmosphere</span>
<span class="sd">        min_sin_altitude: numeric, default 0.065</span>
<span class="sd">            Minimum value of sin(altitude) to allow when calculating global</span>
<span class="sd">            clearness index `kt`. Equivalent to altitude = 3.727 degrees.</span>
<span class="sd">        max_clearness_index: numeric, default 2.0</span>
<span class="sd">            Maximum value of the clearness index. The default, 2.0, allows</span>
<span class="sd">            for over-irradiance events typically seen in sub-hourly data.</span>
<span class="sd">            NREL&#39;s SRRL Fortran code used 0.82 for hourly data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        kt -- numeric.</span>
<span class="sd">        Clearness index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sin_altitude</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">altitude</span><span class="p">))</span>
    <span class="n">I0h</span> <span class="o">=</span> <span class="n">extra_radiation</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">sin_altitude</span><span class="p">,</span> <span class="n">min_sin_altitude</span><span class="p">)</span>
    <span class="n">kt</span> <span class="o">=</span> <span class="n">ghi</span> <span class="o">/</span> <span class="n">I0h</span>
    <span class="n">kt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">kt</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">kt</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kt</span><span class="p">,</span> <span class="n">max_clearness_index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kt</span></div>


<div class="viewcode-block" id="clearness_index_zenith_independent"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.clearness_index_zenith_independent">[docs]</a><span class="k">def</span> <span class="nf">clearness_index_zenith_independent</span><span class="p">(</span><span class="n">clearness_index</span><span class="p">,</span> <span class="n">airmass</span><span class="p">,</span>
                                       <span class="n">max_clearness_index</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the zenith angle independent clearness index.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Perez, R., P. Ineichen, E. Maxwell, R. Seals and A. Zelenka,</span>
<span class="sd">        (1992). &quot;Dynamic Global-to-Direct Irradiance Conversion Models&quot;.</span>
<span class="sd">        ASHRAE Transactions-Research Series, pp. 354-369</span>

<span class="sd">    Args:</span>
<span class="sd">        clearness_index: numeric.</span>
<span class="sd">            Ratio of global to extraterrestrial irradiance on a horizontal</span>
<span class="sd">            plane</span>
<span class="sd">        airmass: numeric</span>
<span class="sd">            Airmass</span>
<span class="sd">        max_clearness_index: numeric, default 2.0</span>
<span class="sd">            Maximum value of the clearness index. The default, 2.0, allows</span>
<span class="sd">            for over-irradiance events typically seen in sub-hourly data.</span>
<span class="sd">            NREL&#39;s SRRL Fortran code used 0.82 for hourly data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        kt_prime -- numeric.</span>
<span class="sd">        Zenith independent clearness index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">airmass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Perez eqn 1</span>
        <span class="n">kt_prime</span> <span class="o">=</span> <span class="n">clearness_index</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.031</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.4</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.9</span> <span class="o">+</span> <span class="mf">9.4</span> <span class="o">/</span> <span class="n">airmass</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">kt_prime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">kt_prime</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">kt_prime</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kt_prime</span><span class="p">,</span> <span class="n">max_clearness_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kt_prime</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="get_absolute_airmass"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.get_absolute_airmass">[docs]</a><span class="k">def</span> <span class="nf">get_absolute_airmass</span><span class="p">(</span><span class="n">airmass_relative</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine absolute (pressure corrected) airmass from relative</span>
<span class="sd">    airmass and atmospheirc pressure.</span>

<span class="sd">    Gives the airmass for locations not at sea-level (i.e. not at</span>
<span class="sd">    standard pressure). The input argument airmass_relative is the relative</span>
<span class="sd">    air mass. The input argument pressure is the pressure (in Pascals)</span>
<span class="sd">    at the location of interest and must be greater than 0. The</span>
<span class="sd">    calculation for absolute air mass is</span>
<span class="sd">    `absolute airmass = (relative airmass)*pressure/101325`</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] C. Gueymard, &quot;Critical analysis and performance assessment of</span>
<span class="sd">        clear sky solar irradiance models using theoretical and measured</span>
<span class="sd">        data,&quot; Solar Energy, vol. 51, pp. 121-138, 1993.</span>

<span class="sd">    Args:</span>
<span class="sd">        airmass_relative: numeric.</span>
<span class="sd">            The air mass at sea-level.</span>
<span class="sd">        pressure: numeric, default 101325</span>
<span class="sd">            The site pressure in Pascal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        airmass_absolute -- numeric.</span>
<span class="sd">        Absolute (pressure corrected) air mass</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">airmass_relative</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">airmass_relative</span> <span class="o">*</span> <span class="n">pressure</span> <span class="o">/</span> <span class="mf">101325.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="get_relative_airmass"><a class="viewcode-back" href="../../ladybug.skymodel.html#ladybug.skymodel.get_relative_airmass">[docs]</a><span class="k">def</span> <span class="nf">get_relative_airmass</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;kastenyoung1989&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gives the relative (not pressure-corrected) airmass.</span>

<span class="sd">    Gives the airmass at sea-level when given a sun altitude angle (in</span>
<span class="sd">    degrees). The `model` variable allows selection of different</span>
<span class="sd">    airmass models (described below). If `model` is not included or is</span>
<span class="sd">    not valid, the default model is &#39;kastenyoung1989&#39;.</span>

<span class="sd">    Note:</span>
<span class="sd">        [1] Fritz Kasten. &quot;A New Table and Approximation Formula for the</span>
<span class="sd">        Relative Optical Air Mass&quot;. Technical Report 136, Hanover, N.H.:</span>
<span class="sd">        U.S. Army Material Command, CRREL.</span>
<span class="sd">        [2] A. T. Young and W. M. Irvine, &quot;Multicolor Photoelectric</span>
<span class="sd">        Photometry of the Brighter Planets,&quot; The Astronomical Journal, vol.</span>
<span class="sd">        72, pp. 945-950, 1967.</span>
<span class="sd">        [3] Fritz Kasten and Andrew Young. &quot;Revised optical air mass tables</span>
<span class="sd">        and approximation formula&quot;. Applied Optics 28:4735-4738</span>
<span class="sd">        [4] C. Gueymard, &quot;Critical analysis and performance assessment of</span>
<span class="sd">        clear sky solar irradiance models using theoretical and measured</span>
<span class="sd">        data,&quot; Solar Energy, vol. 51, pp. 121-138, 1993.</span>
<span class="sd">        [5] A. T. Young, &quot;AIR-MASS AND REFRACTION,&quot; Applied Optics, vol. 33,</span>
<span class="sd">        pp. 1108-1110, Feb 1994.</span>
<span class="sd">        [6] Keith A. Pickering. &quot;The Ancient Star Catalog&quot;. DIO 12:1, 20,</span>
<span class="sd">        [7] Matthew J. Reno, Clifford W. Hansen and Joshua S. Stein, &quot;Global</span>
<span class="sd">        Horizontal Irradiance Clear Sky Models: Implementation and Analysis&quot;</span>
<span class="sd">        Sandia Report, (2012).</span>

<span class="sd">    Args:</span>
<span class="sd">        altitude: numeric</span>
<span class="sd">            Altitude angle of the sun in degrees. Note that some models use</span>
<span class="sd">            the apparent (refraction corrected) altitude angle, and some</span>
<span class="sd">            models use the true (not refraction-corrected) altitude angle. See</span>
<span class="sd">            model descriptions to determine which type of altitude angle is</span>
<span class="sd">            required. Apparent altitude angles must be calculated at sea level.</span>
<span class="sd">        model: string, default &#39;kastenyoung1989&#39;</span>

<span class="sd">                Available models include the following:</span>

<span class="sd">                *   &#39;simple&#39; - secant(apparent altitude angle) -</span>
<span class="sd">                    Note that this gives -inf at altitude=0</span>
<span class="sd">                *   &#39;kasten1966&#39; - See reference [1] -</span>
<span class="sd">                    requires apparent sun altitude</span>
<span class="sd">                *   &#39;youngirvine1967&#39; - See reference [2] -</span>
<span class="sd">                    requires true sun altitude</span>
<span class="sd">                *   &#39;kastenyoung1989&#39; - See reference [3] -</span>
<span class="sd">                    requires apparent sun altitude</span>
<span class="sd">                *   &#39;gueymard1993&#39; - See reference [4] -</span>
<span class="sd">                    requires apparent sun altitude</span>
<span class="sd">                *   &#39;young1994&#39; - See reference [5] -</span>
<span class="sd">                    requries true sun altitude</span>
<span class="sd">                *   &#39;pickering2002&#39; - See reference [6] -</span>
<span class="sd">                    requires apparent sun altitude</span>

<span class="sd">    Returns:</span>
<span class="sd">        airmass_relative -- Relative airmass at sea level. Will return None for any</span>
<span class="sd">        altitude angle smaller than 0 degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">altitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">alt_rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;kastenyoung1989&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span> <span class="o">+</span>
                  <span class="mf">0.50572</span><span class="o">*</span><span class="p">(((</span><span class="mf">6.07995</span> <span class="o">+</span> <span class="n">altitude</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span> <span class="mf">1.6364</span><span class="p">))))</span>
        <span class="k">elif</span> <span class="s1">&#39;kasten1966&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.15</span><span class="o">*</span><span class="p">((</span><span class="mf">3.885</span> <span class="o">+</span> <span class="n">altitude</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span> <span class="mf">1.253</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s1">&#39;simple&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;pickering2002&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">altitude</span> <span class="o">+</span>
                  <span class="mf">244.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">165</span> <span class="o">+</span> <span class="mf">47.0</span> <span class="o">*</span> <span class="n">altitude</span> <span class="o">**</span> <span class="mf">1.1</span><span class="p">)))))</span>
        <span class="k">elif</span> <span class="s1">&#39;youngirvine1967&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">sec_zen</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span>
            <span class="n">am</span> <span class="o">=</span> <span class="n">sec_zen</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.0012</span> <span class="o">*</span> <span class="p">(</span><span class="n">sec_zen</span> <span class="o">*</span> <span class="n">sec_zen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s1">&#39;young1994&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.002432</span><span class="o">*</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                  <span class="mf">0.148386</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.0096467</span><span class="p">)</span> <span class="o">/</span>
                  <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span>
                  <span class="mf">0.149864</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                  <span class="mf">0.0102963</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.000303978</span><span class="p">))</span>
        <span class="k">elif</span> <span class="s1">&#39;gueymard1993&#39;</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">am</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alt_rad</span><span class="p">)</span> <span class="o">+</span>
                  <span class="mf">0.00176759</span><span class="o">*</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">altitude</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
                      <span class="p">(</span><span class="mf">94.37515</span> <span class="o">-</span> <span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">altitude</span><span class="p">))</span> <span class="o">**</span> <span class="o">-</span> <span class="mf">1.21563</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid model for relativeairmass&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">am</span></div>


<span class="k">def</span> <span class="nf">_get_dirint_coeffs</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Here be a large multi-dimensional matrix of dirint coefficients.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array with shape ``(6, 6, 7, 5)``.</span>
<span class="sd">        Ordering is ``[kt_prime_bin, zenith_bin, delta_kt_prime_bin, w_bin]``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.385230</span><span class="p">,</span> <span class="mf">0.385230</span><span class="p">,</span> <span class="mf">0.385230</span><span class="p">,</span> <span class="mf">0.462880</span><span class="p">,</span> <span class="mf">0.317440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.338390</span><span class="p">,</span> <span class="mf">0.338390</span><span class="p">,</span> <span class="mf">0.221270</span><span class="p">,</span> <span class="mf">0.316730</span><span class="p">,</span> <span class="mf">0.503650</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.235680</span><span class="p">,</span> <span class="mf">0.235680</span><span class="p">,</span> <span class="mf">0.241280</span><span class="p">,</span> <span class="mf">0.157830</span><span class="p">,</span> <span class="mf">0.269440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.830130</span><span class="p">,</span> <span class="mf">0.830130</span><span class="p">,</span> <span class="mf">0.171970</span><span class="p">,</span> <span class="mf">0.841070</span><span class="p">,</span> <span class="mf">0.457370</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.548010</span><span class="p">,</span> <span class="mf">0.548010</span><span class="p">,</span> <span class="mf">0.478000</span><span class="p">,</span> <span class="mf">0.966880</span><span class="p">,</span> <span class="mf">1.036370</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.548010</span><span class="p">,</span> <span class="mf">0.548010</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">3.012370</span><span class="p">,</span> <span class="mf">1.976540</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.582690</span><span class="p">,</span> <span class="mf">0.582690</span><span class="p">,</span> <span class="mf">0.229720</span><span class="p">,</span> <span class="mf">0.892710</span><span class="p">,</span> <span class="mf">0.569950</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.131280</span><span class="p">,</span> <span class="mf">0.131280</span><span class="p">,</span> <span class="mf">0.385460</span><span class="p">,</span> <span class="mf">0.511070</span><span class="p">,</span> <span class="mf">0.127940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.223710</span><span class="p">,</span> <span class="mf">0.223710</span><span class="p">,</span> <span class="mf">0.193560</span><span class="p">,</span> <span class="mf">0.304560</span><span class="p">,</span> <span class="mf">0.193940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.229970</span><span class="p">,</span> <span class="mf">0.229970</span><span class="p">,</span> <span class="mf">0.275020</span><span class="p">,</span> <span class="mf">0.312730</span><span class="p">,</span> <span class="mf">0.244610</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.090100</span><span class="p">,</span> <span class="mf">0.184580</span><span class="p">,</span> <span class="mf">0.260500</span><span class="p">,</span> <span class="mf">0.687480</span><span class="p">,</span> <span class="mf">0.579440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.131530</span><span class="p">,</span> <span class="mf">0.131530</span><span class="p">,</span> <span class="mf">0.370190</span><span class="p">,</span> <span class="mf">1.380350</span><span class="p">,</span> <span class="mf">1.052270</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.116250</span><span class="p">,</span> <span class="mf">1.116250</span><span class="p">,</span> <span class="mf">0.928030</span><span class="p">,</span> <span class="mf">3.525490</span><span class="p">,</span> <span class="mf">2.316920</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.090100</span><span class="p">,</span> <span class="mf">0.237000</span><span class="p">,</span> <span class="mf">0.300040</span><span class="p">,</span> <span class="mf">0.812470</span><span class="p">,</span> <span class="mf">0.664970</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.587510</span><span class="p">,</span> <span class="mf">0.130000</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.537210</span><span class="p">,</span> <span class="mf">0.832490</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.306210</span><span class="p">,</span> <span class="mf">0.129830</span><span class="p">,</span> <span class="mf">0.204460</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.681640</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.224020</span><span class="p">,</span> <span class="mf">0.260620</span><span class="p">,</span> <span class="mf">0.334080</span><span class="p">,</span> <span class="mf">0.501040</span><span class="p">,</span> <span class="mf">0.350470</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.421540</span><span class="p">,</span> <span class="mf">0.753970</span><span class="p">,</span> <span class="mf">0.750660</span><span class="p">,</span> <span class="mf">3.706840</span><span class="p">,</span> <span class="mf">0.983790</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.706680</span><span class="p">,</span> <span class="mf">0.373530</span><span class="p">,</span> <span class="mf">1.245670</span><span class="p">,</span> <span class="mf">0.864860</span><span class="p">,</span> <span class="mf">1.992630</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">4.864400</span><span class="p">,</span> <span class="mf">0.117390</span><span class="p">,</span> <span class="mf">0.265180</span><span class="p">,</span> <span class="mf">0.359180</span><span class="p">,</span> <span class="mf">3.310820</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.392080</span><span class="p">,</span> <span class="mf">0.493290</span><span class="p">,</span> <span class="mf">0.651560</span><span class="p">,</span> <span class="mf">1.932780</span><span class="p">,</span> <span class="mf">0.898730</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">2.500000</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">4.000000</span><span class="p">,</span> <span class="mf">3.000000</span><span class="p">,</span> <span class="mf">2.000000</span><span class="p">,</span> <span class="mf">0.975430</span><span class="p">,</span> <span class="mf">1.965570</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">12.494170</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">8.000000</span><span class="p">,</span> <span class="mf">5.083520</span><span class="p">,</span> <span class="mf">8.792390</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">1.620760</span><span class="p">,</span> <span class="mf">1.375250</span><span class="p">,</span> <span class="mf">2.331620</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">2.500000</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">4.000000</span><span class="p">,</span> <span class="mf">3.000000</span><span class="p">,</span> <span class="mf">2.000000</span><span class="p">,</span> <span class="mf">0.975430</span><span class="p">,</span> <span class="mf">1.965570</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">12.494170</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">8.000000</span><span class="p">,</span> <span class="mf">5.083520</span><span class="p">,</span> <span class="mf">8.792390</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">1.620760</span><span class="p">,</span> <span class="mf">1.375250</span><span class="p">,</span> <span class="mf">2.331620</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">,</span> <span class="mf">0.126970</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">,</span> <span class="mf">0.810820</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">2.500000</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">,</span> <span class="mf">2.291440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">4.000000</span><span class="p">,</span> <span class="mf">3.000000</span><span class="p">,</span> <span class="mf">2.000000</span><span class="p">,</span> <span class="mf">0.975430</span><span class="p">,</span> <span class="mf">1.965570</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">12.494170</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">8.000000</span><span class="p">,</span> <span class="mf">5.083520</span><span class="p">,</span> <span class="mf">8.792390</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">,</span> <span class="mf">21.744240</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.241680</span><span class="p">,</span> <span class="mf">12.494170</span><span class="p">,</span> <span class="mf">1.620760</span><span class="p">,</span> <span class="mf">1.375250</span><span class="p">,</span> <span class="mf">2.331620</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.969110</span><span class="p">,</span> <span class="mf">1.097190</span><span class="p">,</span> <span class="mf">1.116080</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.969110</span><span class="p">,</span> <span class="mf">1.116030</span><span class="p">,</span> <span class="mf">0.623900</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">1.530590</span><span class="p">,</span> <span class="mf">1.024420</span><span class="p">,</span> <span class="mf">0.908480</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.584040</span><span class="p">,</span> <span class="mf">0.584040</span><span class="p">,</span> <span class="mf">0.847250</span><span class="p">,</span> <span class="mf">0.914940</span><span class="p">,</span> <span class="mf">1.289300</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.310240</span><span class="p">,</span> <span class="mf">1.435020</span><span class="p">,</span> <span class="mf">1.852830</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">1.015010</span><span class="p">,</span> <span class="mf">1.097190</span><span class="p">,</span> <span class="mf">2.117230</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.337440</span><span class="p">,</span> <span class="mf">0.969110</span><span class="p">,</span> <span class="mf">1.145730</span><span class="p">,</span> <span class="mf">1.476400</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.300000</span><span class="p">,</span> <span class="mf">0.300000</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">1.100000</span><span class="p">,</span> <span class="mf">0.796940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.219870</span><span class="p">,</span> <span class="mf">0.219870</span><span class="p">,</span> <span class="mf">0.526530</span><span class="p">,</span> <span class="mf">0.809610</span><span class="p">,</span> <span class="mf">0.649300</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.386650</span><span class="p">,</span> <span class="mf">0.386650</span><span class="p">,</span> <span class="mf">0.119320</span><span class="p">,</span> <span class="mf">0.576120</span><span class="p">,</span> <span class="mf">0.685460</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.746730</span><span class="p">,</span> <span class="mf">0.399830</span><span class="p">,</span> <span class="mf">0.470970</span><span class="p">,</span> <span class="mf">0.986530</span><span class="p">,</span> <span class="mf">0.785370</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.575420</span><span class="p">,</span> <span class="mf">0.936700</span><span class="p">,</span> <span class="mf">1.649200</span><span class="p">,</span> <span class="mf">1.495840</span><span class="p">,</span> <span class="mf">1.335590</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.319670</span><span class="p">,</span> <span class="mf">4.002570</span><span class="p">,</span> <span class="mf">1.276390</span><span class="p">,</span> <span class="mf">2.644550</span><span class="p">,</span> <span class="mf">2.518670</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.665190</span><span class="p">,</span> <span class="mf">0.678910</span><span class="p">,</span> <span class="mf">1.012360</span><span class="p">,</span> <span class="mf">1.199940</span><span class="p">,</span> <span class="mf">0.986580</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.378870</span><span class="p">,</span> <span class="mf">0.974060</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.491880</span><span class="p">,</span> <span class="mf">0.665290</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.105210</span><span class="p">,</span> <span class="mf">0.263470</span><span class="p">,</span> <span class="mf">0.407040</span><span class="p">,</span> <span class="mf">0.553460</span><span class="p">,</span> <span class="mf">0.582590</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.312900</span><span class="p">,</span> <span class="mf">0.345240</span><span class="p">,</span> <span class="mf">1.144180</span><span class="p">,</span> <span class="mf">0.854790</span><span class="p">,</span> <span class="mf">0.612280</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.119070</span><span class="p">,</span> <span class="mf">0.365120</span><span class="p">,</span> <span class="mf">0.560520</span><span class="p">,</span> <span class="mf">0.793720</span><span class="p">,</span> <span class="mf">0.802600</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.781610</span><span class="p">,</span> <span class="mf">0.837390</span><span class="p">,</span> <span class="mf">1.270420</span><span class="p">,</span> <span class="mf">1.537980</span><span class="p">,</span> <span class="mf">1.292950</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.152290</span><span class="p">,</span> <span class="mf">1.152290</span><span class="p">,</span> <span class="mf">1.492080</span><span class="p">,</span> <span class="mf">1.245370</span><span class="p">,</span> <span class="mf">2.177100</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.424660</span><span class="p">,</span> <span class="mf">0.529550</span><span class="p">,</span> <span class="mf">0.966910</span><span class="p">,</span> <span class="mf">1.033460</span><span class="p">,</span> <span class="mf">0.958730</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.310590</span><span class="p">,</span> <span class="mf">0.714410</span><span class="p">,</span> <span class="mf">0.252450</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.607600</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.975190</span><span class="p">,</span> <span class="mf">0.363420</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.502800</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.175580</span><span class="p">,</span> <span class="mf">0.196250</span><span class="p">,</span> <span class="mf">0.476360</span><span class="p">,</span> <span class="mf">1.072470</span><span class="p">,</span> <span class="mf">0.490510</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.719280</span><span class="p">,</span> <span class="mf">0.698620</span><span class="p">,</span> <span class="mf">0.657770</span><span class="p">,</span> <span class="mf">1.190840</span><span class="p">,</span> <span class="mf">0.681110</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.426240</span><span class="p">,</span> <span class="mf">1.464840</span><span class="p">,</span> <span class="mf">0.678550</span><span class="p">,</span> <span class="mf">1.157730</span><span class="p">,</span> <span class="mf">0.978430</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">2.501120</span><span class="p">,</span> <span class="mf">1.789130</span><span class="p">,</span> <span class="mf">1.387090</span><span class="p">,</span> <span class="mf">2.394180</span><span class="p">,</span> <span class="mf">2.394180</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.491640</span><span class="p">,</span> <span class="mf">0.677610</span><span class="p">,</span> <span class="mf">0.685610</span><span class="p">,</span> <span class="mf">1.082400</span><span class="p">,</span> <span class="mf">0.735410</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.597000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.300000</span><span class="p">,</span> <span class="mf">0.310050</span><span class="p">,</span> <span class="mf">0.413510</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.314790</span><span class="p">,</span> <span class="mf">0.336310</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.442460</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.166510</span><span class="p">,</span> <span class="mf">0.460440</span><span class="p">,</span> <span class="mf">0.552570</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">0.461610</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.401020</span><span class="p">,</span> <span class="mf">0.559110</span><span class="p">,</span> <span class="mf">0.403630</span><span class="p">,</span> <span class="mf">1.016710</span><span class="p">,</span> <span class="mf">0.671490</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.400360</span><span class="p">,</span> <span class="mf">0.750830</span><span class="p">,</span> <span class="mf">0.842640</span><span class="p">,</span> <span class="mf">1.802600</span><span class="p">,</span> <span class="mf">1.023830</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.315300</span><span class="p">,</span> <span class="mf">1.510380</span><span class="p">,</span> <span class="mf">2.443650</span><span class="p">,</span> <span class="mf">1.638820</span><span class="p">,</span> <span class="mf">2.133990</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.530790</span><span class="p">,</span> <span class="mf">0.745850</span><span class="p">,</span> <span class="mf">0.693050</span><span class="p">,</span> <span class="mf">1.458040</span><span class="p">,</span> <span class="mf">0.804500</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.597000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.300000</span><span class="p">,</span> <span class="mf">0.310050</span><span class="p">,</span> <span class="mf">0.800920</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.314790</span><span class="p">,</span> <span class="mf">0.336310</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.237040</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.166510</span><span class="p">,</span> <span class="mf">0.460440</span><span class="p">,</span> <span class="mf">0.552570</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">0.581990</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.401020</span><span class="p">,</span> <span class="mf">0.559110</span><span class="p">,</span> <span class="mf">0.403630</span><span class="p">,</span> <span class="mf">1.016710</span><span class="p">,</span> <span class="mf">0.898570</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.400360</span><span class="p">,</span> <span class="mf">0.750830</span><span class="p">,</span> <span class="mf">0.842640</span><span class="p">,</span> <span class="mf">1.802600</span><span class="p">,</span> <span class="mf">3.400390</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.315300</span><span class="p">,</span> <span class="mf">1.510380</span><span class="p">,</span> <span class="mf">2.443650</span><span class="p">,</span> <span class="mf">1.638820</span><span class="p">,</span> <span class="mf">2.508780</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.204340</span><span class="p">,</span> <span class="mf">1.157740</span><span class="p">,</span> <span class="mf">2.003080</span><span class="p">,</span> <span class="mf">2.622080</span><span class="p">,</span> <span class="mf">1.409380</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.242210</span><span class="p">,</span> <span class="mf">1.242210</span><span class="p">,</span> <span class="mf">1.242210</span><span class="p">,</span> <span class="mf">1.242210</span><span class="p">,</span> <span class="mf">1.242210</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.056980</span><span class="p">,</span> <span class="mf">0.056980</span><span class="p">,</span> <span class="mf">0.656990</span><span class="p">,</span> <span class="mf">0.656990</span><span class="p">,</span> <span class="mf">0.925160</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.089090</span><span class="p">,</span> <span class="mf">0.089090</span><span class="p">,</span> <span class="mf">1.040430</span><span class="p">,</span> <span class="mf">1.232480</span><span class="p">,</span> <span class="mf">1.205300</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.053850</span><span class="p">,</span> <span class="mf">1.053850</span><span class="p">,</span> <span class="mf">1.399690</span><span class="p">,</span> <span class="mf">1.084640</span><span class="p">,</span> <span class="mf">1.233340</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.151540</span><span class="p">,</span> <span class="mf">1.151540</span><span class="p">,</span> <span class="mf">1.118290</span><span class="p">,</span> <span class="mf">1.531640</span><span class="p">,</span> <span class="mf">1.411840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.494980</span><span class="p">,</span> <span class="mf">1.494980</span><span class="p">,</span> <span class="mf">1.700000</span><span class="p">,</span> <span class="mf">1.800810</span><span class="p">,</span> <span class="mf">1.671600</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.018450</span><span class="p">,</span> <span class="mf">1.018450</span><span class="p">,</span> <span class="mf">1.153600</span><span class="p">,</span> <span class="mf">1.321890</span><span class="p">,</span> <span class="mf">1.294670</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">1.023460</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.945830</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.886300</span><span class="p">,</span> <span class="mf">0.886300</span><span class="p">,</span> <span class="mf">1.333620</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">1.066620</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.902180</span><span class="p">,</span> <span class="mf">0.902180</span><span class="p">,</span> <span class="mf">0.954330</span><span class="p">,</span> <span class="mf">1.126690</span><span class="p">,</span> <span class="mf">1.097310</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.095300</span><span class="p">,</span> <span class="mf">1.075060</span><span class="p">,</span> <span class="mf">1.176490</span><span class="p">,</span> <span class="mf">1.139470</span><span class="p">,</span> <span class="mf">1.096110</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.201660</span><span class="p">,</span> <span class="mf">1.201660</span><span class="p">,</span> <span class="mf">1.438200</span><span class="p">,</span> <span class="mf">1.256280</span><span class="p">,</span> <span class="mf">1.198060</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.525850</span><span class="p">,</span> <span class="mf">1.525850</span><span class="p">,</span> <span class="mf">1.869160</span><span class="p">,</span> <span class="mf">1.985410</span><span class="p">,</span> <span class="mf">1.911590</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.288220</span><span class="p">,</span> <span class="mf">1.082810</span><span class="p">,</span> <span class="mf">1.286370</span><span class="p">,</span> <span class="mf">1.166170</span><span class="p">,</span> <span class="mf">1.119330</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.600000</span><span class="p">,</span> <span class="mf">1.029910</span><span class="p">,</span> <span class="mf">0.859890</span><span class="p">,</span> <span class="mf">0.550000</span><span class="p">,</span> <span class="mf">0.813600</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.604450</span><span class="p">,</span> <span class="mf">1.029910</span><span class="p">,</span> <span class="mf">0.859890</span><span class="p">,</span> <span class="mf">0.656700</span><span class="p">,</span> <span class="mf">0.928840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.455850</span><span class="p">,</span> <span class="mf">0.750580</span><span class="p">,</span> <span class="mf">0.804930</span><span class="p">,</span> <span class="mf">0.823000</span><span class="p">,</span> <span class="mf">0.911000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.526580</span><span class="p">,</span> <span class="mf">0.932310</span><span class="p">,</span> <span class="mf">0.908620</span><span class="p">,</span> <span class="mf">0.983520</span><span class="p">,</span> <span class="mf">0.988090</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.036110</span><span class="p">,</span> <span class="mf">1.100690</span><span class="p">,</span> <span class="mf">0.848380</span><span class="p">,</span> <span class="mf">1.035270</span><span class="p">,</span> <span class="mf">1.042380</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.048440</span><span class="p">,</span> <span class="mf">1.652720</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">2.350410</span><span class="p">,</span> <span class="mf">1.082950</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.817410</span><span class="p">,</span> <span class="mf">0.976160</span><span class="p">,</span> <span class="mf">0.861300</span><span class="p">,</span> <span class="mf">0.974780</span><span class="p">,</span> <span class="mf">1.004580</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.782110</span><span class="p">,</span> <span class="mf">0.564280</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.665740</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.894480</span><span class="p">,</span> <span class="mf">0.680730</span><span class="p">,</span> <span class="mf">0.541990</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.669140</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.487460</span><span class="p">,</span> <span class="mf">0.818950</span><span class="p">,</span> <span class="mf">0.841830</span><span class="p">,</span> <span class="mf">0.872540</span><span class="p">,</span> <span class="mf">0.709040</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.709310</span><span class="p">,</span> <span class="mf">0.872780</span><span class="p">,</span> <span class="mf">0.908480</span><span class="p">,</span> <span class="mf">0.953290</span><span class="p">,</span> <span class="mf">0.844350</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.863920</span><span class="p">,</span> <span class="mf">0.947770</span><span class="p">,</span> <span class="mf">0.876220</span><span class="p">,</span> <span class="mf">1.078750</span><span class="p">,</span> <span class="mf">0.936910</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.280350</span><span class="p">,</span> <span class="mf">0.866720</span><span class="p">,</span> <span class="mf">0.769790</span><span class="p">,</span> <span class="mf">1.078750</span><span class="p">,</span> <span class="mf">0.975130</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.725420</span><span class="p">,</span> <span class="mf">0.869970</span><span class="p">,</span> <span class="mf">0.868810</span><span class="p">,</span> <span class="mf">0.951190</span><span class="p">,</span> <span class="mf">0.829220</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.791750</span><span class="p">,</span> <span class="mf">0.654040</span><span class="p">,</span> <span class="mf">0.483170</span><span class="p">,</span> <span class="mf">0.409000</span><span class="p">,</span> <span class="mf">0.597180</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.566140</span><span class="p">,</span> <span class="mf">0.948990</span><span class="p">,</span> <span class="mf">0.971820</span><span class="p">,</span> <span class="mf">0.653570</span><span class="p">,</span> <span class="mf">0.718550</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.648710</span><span class="p">,</span> <span class="mf">0.637730</span><span class="p">,</span> <span class="mf">0.870510</span><span class="p">,</span> <span class="mf">0.860600</span><span class="p">,</span> <span class="mf">0.694300</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.637630</span><span class="p">,</span> <span class="mf">0.767610</span><span class="p">,</span> <span class="mf">0.925670</span><span class="p">,</span> <span class="mf">0.990310</span><span class="p">,</span> <span class="mf">0.847670</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.736380</span><span class="p">,</span> <span class="mf">0.946060</span><span class="p">,</span> <span class="mf">1.117590</span><span class="p">,</span> <span class="mf">1.029340</span><span class="p">,</span> <span class="mf">0.947020</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.180970</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">1.050000</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.888580</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.700560</span><span class="p">,</span> <span class="mf">0.801440</span><span class="p">,</span> <span class="mf">0.961970</span><span class="p">,</span> <span class="mf">0.906140</span><span class="p">,</span> <span class="mf">0.823880</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.586770</span><span class="p">,</span> <span class="mf">0.470550</span><span class="p">,</span> <span class="mf">0.629790</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">1.056220</span><span class="p">,</span> <span class="mf">1.260140</span><span class="p">,</span> <span class="mf">0.658140</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.631830</span><span class="p">,</span> <span class="mf">0.842620</span><span class="p">,</span> <span class="mf">0.582780</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.554710</span><span class="p">,</span> <span class="mf">0.734730</span><span class="p">,</span> <span class="mf">0.985820</span><span class="p">,</span> <span class="mf">0.915640</span><span class="p">,</span> <span class="mf">0.898260</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.712510</span><span class="p">,</span> <span class="mf">1.205990</span><span class="p">,</span> <span class="mf">0.909510</span><span class="p">,</span> <span class="mf">1.078260</span><span class="p">,</span> <span class="mf">0.885610</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.899260</span><span class="p">,</span> <span class="mf">1.559710</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.150000</span><span class="p">,</span> <span class="mf">1.120390</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.653880</span><span class="p">,</span> <span class="mf">0.793120</span><span class="p">,</span> <span class="mf">0.903320</span><span class="p">,</span> <span class="mf">0.944070</span><span class="p">,</span> <span class="mf">0.796130</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.050000</span><span class="p">,</span> <span class="mf">1.170380</span><span class="p">,</span> <span class="mf">1.178090</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.960580</span><span class="p">,</span> <span class="mf">0.960580</span><span class="p">,</span> <span class="mf">1.059530</span><span class="p">,</span> <span class="mf">1.179030</span><span class="p">,</span> <span class="mf">1.131690</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.871470</span><span class="p">,</span> <span class="mf">0.871470</span><span class="p">,</span> <span class="mf">0.995860</span><span class="p">,</span> <span class="mf">1.141910</span><span class="p">,</span> <span class="mf">1.114600</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.201590</span><span class="p">,</span> <span class="mf">1.201590</span><span class="p">,</span> <span class="mf">0.993610</span><span class="p">,</span> <span class="mf">1.109380</span><span class="p">,</span> <span class="mf">1.126320</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.065010</span><span class="p">,</span> <span class="mf">1.065010</span><span class="p">,</span> <span class="mf">0.828660</span><span class="p">,</span> <span class="mf">0.939970</span><span class="p">,</span> <span class="mf">1.017930</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.065010</span><span class="p">,</span> <span class="mf">1.065010</span><span class="p">,</span> <span class="mf">0.623690</span><span class="p">,</span> <span class="mf">1.119620</span><span class="p">,</span> <span class="mf">1.132260</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.071570</span><span class="p">,</span> <span class="mf">1.071570</span><span class="p">,</span> <span class="mf">0.958070</span><span class="p">,</span> <span class="mf">1.114130</span><span class="p">,</span> <span class="mf">1.127110</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.973390</span><span class="p">,</span> <span class="mf">0.852520</span><span class="p">,</span> <span class="mf">1.092200</span><span class="p">,</span> <span class="mf">1.096590</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.804120</span><span class="p">,</span> <span class="mf">0.913870</span><span class="p">,</span> <span class="mf">0.980990</span><span class="p">,</span> <span class="mf">1.094580</span><span class="p">,</span> <span class="mf">1.042420</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.737540</span><span class="p">,</span> <span class="mf">0.935970</span><span class="p">,</span> <span class="mf">0.999940</span><span class="p">,</span> <span class="mf">1.056490</span><span class="p">,</span> <span class="mf">1.050060</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.032980</span><span class="p">,</span> <span class="mf">1.034540</span><span class="p">,</span> <span class="mf">0.968460</span><span class="p">,</span> <span class="mf">1.032080</span><span class="p">,</span> <span class="mf">1.015780</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.977210</span><span class="p">,</span> <span class="mf">0.945960</span><span class="p">,</span> <span class="mf">1.008840</span><span class="p">,</span> <span class="mf">0.969960</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.844710</span><span class="p">,</span> <span class="mf">0.899100</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.926800</span><span class="p">,</span> <span class="mf">0.965030</span><span class="p">,</span> <span class="mf">0.968520</span><span class="p">,</span> <span class="mf">1.044910</span><span class="p">,</span> <span class="mf">1.032310</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.850000</span><span class="p">,</span> <span class="mf">1.029710</span><span class="p">,</span> <span class="mf">0.961100</span><span class="p">,</span> <span class="mf">1.055670</span><span class="p">,</span> <span class="mf">1.009700</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.818530</span><span class="p">,</span> <span class="mf">0.960010</span><span class="p">,</span> <span class="mf">0.996450</span><span class="p">,</span> <span class="mf">1.081970</span><span class="p">,</span> <span class="mf">1.036470</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.765380</span><span class="p">,</span> <span class="mf">0.953500</span><span class="p">,</span> <span class="mf">0.948260</span><span class="p">,</span> <span class="mf">1.052110</span><span class="p">,</span> <span class="mf">1.000140</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.775610</span><span class="p">,</span> <span class="mf">0.909610</span><span class="p">,</span> <span class="mf">0.927800</span><span class="p">,</span> <span class="mf">0.987800</span><span class="p">,</span> <span class="mf">0.952100</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.000990</span><span class="p">,</span> <span class="mf">0.881880</span><span class="p">,</span> <span class="mf">0.875950</span><span class="p">,</span> <span class="mf">0.949100</span><span class="p">,</span> <span class="mf">0.893690</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.902370</span><span class="p">,</span> <span class="mf">0.875960</span><span class="p">,</span> <span class="mf">0.807990</span><span class="p">,</span> <span class="mf">0.942410</span><span class="p">,</span> <span class="mf">0.917920</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.856580</span><span class="p">,</span> <span class="mf">0.928270</span><span class="p">,</span> <span class="mf">0.946820</span><span class="p">,</span> <span class="mf">1.032260</span><span class="p">,</span> <span class="mf">0.972990</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.857930</span><span class="p">,</span> <span class="mf">0.983800</span><span class="p">,</span> <span class="mf">1.056540</span><span class="p">,</span> <span class="mf">0.980240</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.987010</span><span class="p">,</span> <span class="mf">1.013730</span><span class="p">,</span> <span class="mf">1.133780</span><span class="p">,</span> <span class="mf">1.038250</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.947380</span><span class="p">,</span> <span class="mf">1.012380</span><span class="p">,</span> <span class="mf">1.091270</span><span class="p">,</span> <span class="mf">0.999840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.914550</span><span class="p">,</span> <span class="mf">0.908570</span><span class="p">,</span> <span class="mf">0.999190</span><span class="p">,</span> <span class="mf">0.915230</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.778540</span><span class="p">,</span> <span class="mf">0.800590</span><span class="p">,</span> <span class="mf">0.799070</span><span class="p">,</span> <span class="mf">0.902180</span><span class="p">,</span> <span class="mf">0.851560</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.680190</span><span class="p">,</span> <span class="mf">0.317410</span><span class="p">,</span> <span class="mf">0.507680</span><span class="p">,</span> <span class="mf">0.388910</span><span class="p">,</span> <span class="mf">0.646710</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.794920</span><span class="p">,</span> <span class="mf">0.912780</span><span class="p">,</span> <span class="mf">0.960830</span><span class="p">,</span> <span class="mf">1.057110</span><span class="p">,</span> <span class="mf">0.947950</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.833890</span><span class="p">,</span> <span class="mf">0.867530</span><span class="p">,</span> <span class="mf">1.059890</span><span class="p">,</span> <span class="mf">0.932840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.979700</span><span class="p">,</span> <span class="mf">0.971470</span><span class="p">,</span> <span class="mf">0.995510</span><span class="p">,</span> <span class="mf">1.068490</span><span class="p">,</span> <span class="mf">1.030150</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.858850</span><span class="p">,</span> <span class="mf">0.987920</span><span class="p">,</span> <span class="mf">1.043220</span><span class="p">,</span> <span class="mf">1.108700</span><span class="p">,</span> <span class="mf">1.044900</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.802400</span><span class="p">,</span> <span class="mf">0.955110</span><span class="p">,</span> <span class="mf">0.911660</span><span class="p">,</span> <span class="mf">1.045070</span><span class="p">,</span> <span class="mf">0.944470</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.884890</span><span class="p">,</span> <span class="mf">0.766210</span><span class="p">,</span> <span class="mf">0.885390</span><span class="p">,</span> <span class="mf">0.859070</span><span class="p">,</span> <span class="mf">0.818190</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.615680</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.624620</span><span class="p">,</span> <span class="mf">0.669300</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.835570</span><span class="p">,</span> <span class="mf">0.946150</span><span class="p">,</span> <span class="mf">0.977090</span><span class="p">,</span> <span class="mf">1.049350</span><span class="p">,</span> <span class="mf">0.979970</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.689220</span><span class="p">,</span> <span class="mf">0.809600</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.789500</span><span class="p">,</span> <span class="mf">0.853990</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.854660</span><span class="p">,</span> <span class="mf">0.852840</span><span class="p">,</span> <span class="mf">0.938200</span><span class="p">,</span> <span class="mf">0.923110</span><span class="p">,</span> <span class="mf">0.955010</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.938600</span><span class="p">,</span> <span class="mf">0.932980</span><span class="p">,</span> <span class="mf">1.010390</span><span class="p">,</span> <span class="mf">1.043950</span><span class="p">,</span> <span class="mf">1.041640</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.843620</span><span class="p">,</span> <span class="mf">0.981300</span><span class="p">,</span> <span class="mf">0.951590</span><span class="p">,</span> <span class="mf">0.946100</span><span class="p">,</span> <span class="mf">0.966330</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.694740</span><span class="p">,</span> <span class="mf">0.814690</span><span class="p">,</span> <span class="mf">0.572650</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.726830</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.211370</span><span class="p">,</span> <span class="mf">0.671780</span><span class="p">,</span> <span class="mf">0.416340</span><span class="p">,</span> <span class="mf">0.297290</span><span class="p">,</span> <span class="mf">0.498050</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.843540</span><span class="p">,</span> <span class="mf">0.882330</span><span class="p">,</span> <span class="mf">0.911760</span><span class="p">,</span> <span class="mf">0.898420</span><span class="p">,</span> <span class="mf">0.960210</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.054880</span><span class="p">,</span> <span class="mf">1.075210</span><span class="p">,</span> <span class="mf">1.068460</span><span class="p">,</span> <span class="mf">1.153370</span><span class="p">,</span> <span class="mf">1.069220</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.062220</span><span class="p">,</span> <span class="mf">1.013470</span><span class="p">,</span> <span class="mf">1.088170</span><span class="p">,</span> <span class="mf">1.046200</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.885090</span><span class="p">,</span> <span class="mf">0.993530</span><span class="p">,</span> <span class="mf">0.942590</span><span class="p">,</span> <span class="mf">1.054990</span><span class="p">,</span> <span class="mf">1.012740</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.920000</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.978720</span><span class="p">,</span> <span class="mf">1.020280</span><span class="p">,</span> <span class="mf">0.984440</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.908500</span><span class="p">,</span> <span class="mf">0.839940</span><span class="p">,</span> <span class="mf">0.985570</span><span class="p">,</span> <span class="mf">0.962180</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.810080</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.961550</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.038590</span><span class="p">,</span> <span class="mf">1.063200</span><span class="p">,</span> <span class="mf">1.034440</span><span class="p">,</span> <span class="mf">1.112780</span><span class="p">,</span> <span class="mf">1.037800</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.017610</span><span class="p">,</span> <span class="mf">1.028360</span><span class="p">,</span> <span class="mf">1.058960</span><span class="p">,</span> <span class="mf">1.133180</span><span class="p">,</span> <span class="mf">1.045620</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.920000</span><span class="p">,</span> <span class="mf">0.998970</span><span class="p">,</span> <span class="mf">1.033590</span><span class="p">,</span> <span class="mf">1.089030</span><span class="p">,</span> <span class="mf">1.022060</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.912370</span><span class="p">,</span> <span class="mf">0.949930</span><span class="p">,</span> <span class="mf">0.979770</span><span class="p">,</span> <span class="mf">1.020420</span><span class="p">,</span> <span class="mf">0.981770</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.847160</span><span class="p">,</span> <span class="mf">0.935300</span><span class="p">,</span> <span class="mf">0.930540</span><span class="p">,</span> <span class="mf">0.955050</span><span class="p">,</span> <span class="mf">0.946560</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.880260</span><span class="p">,</span> <span class="mf">0.867110</span><span class="p">,</span> <span class="mf">0.874130</span><span class="p">,</span> <span class="mf">0.972650</span><span class="p">,</span> <span class="mf">0.883420</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.627150</span><span class="p">,</span> <span class="mf">0.627150</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.774070</span><span class="p">,</span> <span class="mf">0.845130</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.973700</span><span class="p">,</span> <span class="mf">1.006240</span><span class="p">,</span> <span class="mf">1.026190</span><span class="p">,</span> <span class="mf">1.071960</span><span class="p">,</span> <span class="mf">1.017240</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.028710</span><span class="p">,</span> <span class="mf">1.017570</span><span class="p">,</span> <span class="mf">1.025900</span><span class="p">,</span> <span class="mf">1.081790</span><span class="p">,</span> <span class="mf">1.024240</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.924980</span><span class="p">,</span> <span class="mf">0.985500</span><span class="p">,</span> <span class="mf">1.014100</span><span class="p">,</span> <span class="mf">1.092210</span><span class="p">,</span> <span class="mf">0.999610</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.828570</span><span class="p">,</span> <span class="mf">0.934920</span><span class="p">,</span> <span class="mf">0.994950</span><span class="p">,</span> <span class="mf">1.024590</span><span class="p">,</span> <span class="mf">0.949710</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.900810</span><span class="p">,</span> <span class="mf">0.901330</span><span class="p">,</span> <span class="mf">0.928830</span><span class="p">,</span> <span class="mf">0.979570</span><span class="p">,</span> <span class="mf">0.913100</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.761030</span><span class="p">,</span> <span class="mf">0.845150</span><span class="p">,</span> <span class="mf">0.805360</span><span class="p">,</span> <span class="mf">0.936790</span><span class="p">,</span> <span class="mf">0.853460</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.626400</span><span class="p">,</span> <span class="mf">0.546750</span><span class="p">,</span> <span class="mf">0.730500</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.689050</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.957630</span><span class="p">,</span> <span class="mf">0.985480</span><span class="p">,</span> <span class="mf">0.991790</span><span class="p">,</span> <span class="mf">1.050220</span><span class="p">,</span> <span class="mf">0.987900</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.992730</span><span class="p">,</span> <span class="mf">0.993880</span><span class="p">,</span> <span class="mf">1.017150</span><span class="p">,</span> <span class="mf">1.059120</span><span class="p">,</span> <span class="mf">1.017450</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.975610</span><span class="p">,</span> <span class="mf">0.987160</span><span class="p">,</span> <span class="mf">1.026820</span><span class="p">,</span> <span class="mf">1.075440</span><span class="p">,</span> <span class="mf">1.007250</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.871090</span><span class="p">,</span> <span class="mf">0.933190</span><span class="p">,</span> <span class="mf">0.974690</span><span class="p">,</span> <span class="mf">0.979840</span><span class="p">,</span> <span class="mf">0.952730</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.828750</span><span class="p">,</span> <span class="mf">0.868090</span><span class="p">,</span> <span class="mf">0.834920</span><span class="p">,</span> <span class="mf">0.905510</span><span class="p">,</span> <span class="mf">0.871530</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.781540</span><span class="p">,</span> <span class="mf">0.782470</span><span class="p">,</span> <span class="mf">0.767910</span><span class="p">,</span> <span class="mf">0.764140</span><span class="p">,</span> <span class="mf">0.795890</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.743460</span><span class="p">,</span> <span class="mf">0.693390</span><span class="p">,</span> <span class="mf">0.514870</span><span class="p">,</span> <span class="mf">0.630150</span><span class="p">,</span> <span class="mf">0.715660</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.934760</span><span class="p">,</span> <span class="mf">0.957870</span><span class="p">,</span> <span class="mf">0.959640</span><span class="p">,</span> <span class="mf">0.972510</span><span class="p">,</span> <span class="mf">0.981640</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.965840</span><span class="p">,</span> <span class="mf">0.941240</span><span class="p">,</span> <span class="mf">0.987100</span><span class="p">,</span> <span class="mf">1.022540</span><span class="p">,</span> <span class="mf">1.011160</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.988630</span><span class="p">,</span> <span class="mf">0.994770</span><span class="p">,</span> <span class="mf">0.976590</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">1.034840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.958200</span><span class="p">,</span> <span class="mf">1.018080</span><span class="p">,</span> <span class="mf">0.974480</span><span class="p">,</span> <span class="mf">0.920000</span><span class="p">,</span> <span class="mf">0.989870</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.811720</span><span class="p">,</span> <span class="mf">0.869090</span><span class="p">,</span> <span class="mf">0.812020</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.821050</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.682030</span><span class="p">,</span> <span class="mf">0.679480</span><span class="p">,</span> <span class="mf">0.632450</span><span class="p">,</span> <span class="mf">0.746580</span><span class="p">,</span> <span class="mf">0.738550</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.668290</span><span class="p">,</span> <span class="mf">0.445860</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.678920</span><span class="p">,</span> <span class="mf">0.696510</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.926940</span><span class="p">,</span> <span class="mf">0.953350</span><span class="p">,</span> <span class="mf">0.959050</span><span class="p">,</span> <span class="mf">0.876210</span><span class="p">,</span> <span class="mf">0.991490</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.948940</span><span class="p">,</span> <span class="mf">0.997760</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.826520</span><span class="p">,</span> <span class="mf">0.998470</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.017860</span><span class="p">,</span> <span class="mf">0.970000</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.988560</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.606240</span><span class="p">,</span> <span class="mf">0.947260</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span> <span class="mf">0.746140</span><span class="p">,</span> <span class="mf">0.751740</span><span class="p">,</span> <span class="mf">0.598390</span><span class="p">,</span> <span class="mf">0.725230</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.922210</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.376800</span><span class="p">,</span> <span class="mf">0.517110</span><span class="p">,</span> <span class="mf">0.548630</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.450000</span><span class="p">,</span> <span class="mf">0.429970</span><span class="p">,</span> <span class="mf">0.404490</span><span class="p">,</span> <span class="mf">0.539940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.960430</span><span class="p">,</span> <span class="mf">0.881630</span><span class="p">,</span> <span class="mf">0.775640</span><span class="p">,</span> <span class="mf">0.596350</span><span class="p">,</span> <span class="mf">0.937680</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.030000</span><span class="p">,</span> <span class="mf">1.040000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.049510</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.050000</span><span class="p">,</span> <span class="mf">0.990000</span><span class="p">,</span> <span class="mf">0.990000</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.996530</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.050000</span><span class="p">,</span> <span class="mf">0.990000</span><span class="p">,</span> <span class="mf">0.990000</span><span class="p">,</span> <span class="mf">0.820000</span><span class="p">,</span> <span class="mf">0.971940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.050000</span><span class="p">,</span> <span class="mf">0.790000</span><span class="p">,</span> <span class="mf">0.880000</span><span class="p">,</span> <span class="mf">0.820000</span><span class="p">,</span> <span class="mf">0.951840</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span> <span class="mf">0.530000</span><span class="p">,</span> <span class="mf">0.440000</span><span class="p">,</span> <span class="mf">0.710000</span><span class="p">,</span> <span class="mf">0.928730</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.540000</span><span class="p">,</span> <span class="mf">0.470000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.550000</span><span class="p">,</span> <span class="mf">0.773950</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.038270</span><span class="p">,</span> <span class="mf">0.920180</span><span class="p">,</span> <span class="mf">0.910930</span><span class="p">,</span> <span class="mf">0.821140</span><span class="p">,</span> <span class="mf">1.034560</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.041020</span><span class="p">,</span> <span class="mf">0.997520</span><span class="p">,</span> <span class="mf">0.961600</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.035780</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.948030</span><span class="p">,</span> <span class="mf">0.980000</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.950360</span><span class="p">,</span> <span class="mf">0.977460</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.977250</span><span class="p">,</span> <span class="mf">0.869270</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.951680</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.951870</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.748770</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.883850</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.823190</span><span class="p">,</span> <span class="mf">0.727450</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.839870</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.805020</span><span class="p">,</span> <span class="mf">0.692310</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.788410</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.010090</span><span class="p">,</span> <span class="mf">0.895270</span><span class="p">,</span> <span class="mf">0.773030</span><span class="p">,</span> <span class="mf">0.816280</span><span class="p">,</span> <span class="mf">1.011680</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.022450</span><span class="p">,</span> <span class="mf">1.004600</span><span class="p">,</span> <span class="mf">0.983650</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.032940</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.943960</span><span class="p">,</span> <span class="mf">0.999240</span><span class="p">,</span> <span class="mf">0.983920</span><span class="p">,</span> <span class="mf">0.905990</span><span class="p">,</span> <span class="mf">0.978150</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.936240</span><span class="p">,</span> <span class="mf">0.946480</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.930320</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.816420</span><span class="p">,</span> <span class="mf">0.885000</span><span class="p">,</span> <span class="mf">0.644950</span><span class="p">,</span> <span class="mf">0.817650</span><span class="p">,</span> <span class="mf">0.865310</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.742960</span><span class="p">,</span> <span class="mf">0.765690</span><span class="p">,</span> <span class="mf">0.561520</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.827140</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.643870</span><span class="p">,</span> <span class="mf">0.596710</span><span class="p">,</span> <span class="mf">0.474460</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.651200</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.971740</span><span class="p">,</span> <span class="mf">0.940560</span><span class="p">,</span> <span class="mf">0.714880</span><span class="p">,</span> <span class="mf">0.864380</span><span class="p">,</span> <span class="mf">1.001650</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.995260</span><span class="p">,</span> <span class="mf">0.977010</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.000000</span><span class="p">,</span> <span class="mf">1.035250</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.939810</span><span class="p">,</span> <span class="mf">0.975250</span><span class="p">,</span> <span class="mf">0.939980</span><span class="p">,</span> <span class="mf">0.950000</span><span class="p">,</span> <span class="mf">0.982550</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.876870</span><span class="p">,</span> <span class="mf">0.879440</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.917810</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.873480</span><span class="p">,</span> <span class="mf">0.873450</span><span class="p">,</span> <span class="mf">0.751470</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.863040</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.761470</span><span class="p">,</span> <span class="mf">0.702360</span><span class="p">,</span> <span class="mf">0.638770</span><span class="p">,</span> <span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.783120</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.734080</span><span class="p">,</span> <span class="mf">0.650000</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.650000</span><span class="p">,</span> <span class="mf">0.715660</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.942160</span><span class="p">,</span> <span class="mf">0.919100</span><span class="p">,</span> <span class="mf">0.770340</span><span class="p">,</span> <span class="mf">0.731170</span><span class="p">,</span> <span class="mf">0.995180</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.952560</span><span class="p">,</span> <span class="mf">0.916780</span><span class="p">,</span> <span class="mf">0.920000</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">1.005880</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.928620</span><span class="p">,</span> <span class="mf">0.994420</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.900000</span><span class="p">,</span> <span class="mf">0.983720</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.913070</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.850000</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.924280</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.868090</span><span class="p">,</span> <span class="mf">0.807170</span><span class="p">,</span> <span class="mf">0.823550</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.844520</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.769570</span><span class="p">,</span> <span class="mf">0.719870</span><span class="p">,</span> <span class="mf">0.650000</span><span class="p">,</span> <span class="mf">0.550000</span><span class="p">,</span> <span class="mf">0.733500</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.580250</span><span class="p">,</span> <span class="mf">0.650000</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.628850</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.904770</span><span class="p">,</span> <span class="mf">0.852650</span><span class="p">,</span> <span class="mf">0.708370</span><span class="p">,</span> <span class="mf">0.493730</span><span class="p">,</span> <span class="mf">0.949030</span><span class="p">]]</span>

    <span class="n">coeffs</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.911970</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.800000</span><span class="p">,</span> <span class="mf">0.956320</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.912620</span><span class="p">,</span> <span class="mf">0.682610</span><span class="p">,</span> <span class="mf">0.750000</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.950110</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.653450</span><span class="p">,</span> <span class="mf">0.659330</span><span class="p">,</span> <span class="mf">0.700000</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.856110</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.648440</span><span class="p">,</span> <span class="mf">0.600000</span><span class="p">,</span> <span class="mf">0.641120</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.695780</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.570000</span><span class="p">,</span> <span class="mf">0.550000</span><span class="p">,</span> <span class="mf">0.598800</span><span class="p">,</span> <span class="mf">0.400000</span><span class="p">,</span> <span class="mf">0.560150</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.475230</span><span class="p">,</span> <span class="mf">0.500000</span><span class="p">,</span> <span class="mf">0.518640</span><span class="p">,</span> <span class="mf">0.339970</span><span class="p">,</span> <span class="mf">0.520230</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.743440</span><span class="p">,</span> <span class="mf">0.592190</span><span class="p">,</span> <span class="mf">0.603060</span><span class="p">,</span> <span class="mf">0.316930</span><span class="p">,</span> <span class="mf">0.794390</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">coeffs</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Ladybug Tools.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>